<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Tplyr">
<title>Tplyr Options • Tplyr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Tplyr Options">
<meta property="og:description" content="Tplyr">
<meta property="og:image" content="https://atorus-research.github.io/Tplyr/reference/figures/Atorus_Stickers_vF_Tplyr.png">
<meta property="og:image:alt" content="Tplyr Hex Sticker">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@AtorusR">
<meta name="twitter:site" content="@AtorusR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-165685385-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-165685385-2');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Tplyr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/Tplyr.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Table Basics</h6>
    <a class="dropdown-item" href="../articles/table.html">Tplyr Table Properties</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Layer Basics</h6>
    <a class="dropdown-item" href="../articles/desc.html">Descriptive Statistic Layers</a>
    <a class="dropdown-item" href="../articles/count.html">Count Layers</a>
    <a class="dropdown-item" href="../articles/shift.html">Shift Layers</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Table Customization</h6>
    <a class="dropdown-item" href="../articles/general_string_formatting.html">General String Formatting</a>
    <a class="dropdown-item" href="../articles/desc_layer_formatting.html">Advanced Descriptive Statistic Layer Formatting</a>
    <a class="dropdown-item" href="../articles/sort.html">Sorting a Tplyr Table</a>
    <a class="dropdown-item" href="../articles/denom.html">Totals, Missings, and Denominators</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Metadata</h6>
    <a class="dropdown-item" href="../articles/metadata.html">Tplyr Metadata</a>
    <a class="dropdown-item" href="../articles/custom-metadata.html">Creating Custom Tplyr Metadata</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Advanced</h6>
    <a class="dropdown-item" href="../articles/riskdiff.html">Risk Difference</a>
    <a class="dropdown-item" href="../articles/options.html">Tplyr Options</a>
    <a class="dropdown-item" href="../articles/layer_templates.html">Layer Templates</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Post-processing</h6>
    <a class="dropdown-item" href="../articles/post_processing.html">Post-Processing</a>
    <a class="dropdown-item" href="../articles/styled-table.html">Producing a Styled Table</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/atorus-research/Tplyr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Tplyr Options</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/atorus-research/Tplyr/blob/main/vignettes/options.Rmd" class="external-link"><code>vignettes/options.Rmd</code></a></small>
      <div class="d-none name"><code>options.Rmd</code></div>
    </div>

    
    
<p>One thing that we wanted to build into <strong>Tplyr</strong> to make
it a user friendly package is the ability to eliminate redundant code
where possible. This is why there are several options available in
<strong>Tplyr</strong> to allow you to control things at your session
level instead of each individual table, or even each individual
layer.</p>
<p>The following are the options available in <strong>Tplyr</strong> and
their descriptions:</p>
<table class="table">
<colgroup>
<col width="10%">
<col width="89%">
</colgroup>
<thead><tr class="header">
<th align="center">Option</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">tplyr.count_layer_default_formats</td>
<td align="left">The default format strings for a count layer. Defaults
to an auto-calculated n width, and (xxx.x%) for distinct counts (if
available - non-distinct counts are used otherwise). Risk difference
formats default to dif (low CI, high CI), all with 2 integer spaces and
3 decimal places.</td>
</tr>
<tr class="even">
<td align="center">tplyr.shift_layer_default_formats</td>
<td align="left">The default shift layer format. Defaults to an
auto-calculated n width.</td>
</tr>
<tr class="odd">
<td align="center">tplyr.desc_layer_default_formats</td>
<td align="left">The default descriptive statistics layer format.
Defaults to “n”, “Mean (SD)”, “Median”, “Q1, Q3”, “Min, Max”, and
“Missing”. Everything except “n” and “Missing” use auto-precision. Mean,
Q1, Q3, and median defaults to +1 decimal places and Standard Deviation
defaults to +2.</td>
</tr>
<tr class="even">
<td align="center">tplyr.precision_cap</td>
<td align="left">The default precision cap for auto-precision. Both
integer and decimal places default to 99, essentially ensuring that
precision is not capped by default.</td>
</tr>
<tr class="odd">
<td align="center">tplyr.custom_summaries</td>
<td align="left">Default custom summaries available to Tplyr. Defaults
to NULL, as Tplyr’s defaults are seen as built-ins and not custom
summaries.</td>
</tr>
<tr class="even">
<td align="center">tplyr.scipen</td>
<td align="left">The default ‘scipen’ setting used while Tplyr is
executing. Defaults to 1000. See the R documentation on the ‘scipen’
option to understand more, but this allows you to control how small a
number must be before scientific notation is used when a number is
string formatted in presentation.</td>
</tr>
<tr class="odd">
<td align="center">tplyr.quantile_type</td>
<td align="left">The default quantile algorithm used by Tpylr when using
the built-in summaries for Q1, Q3, and IQR. Defaults to Type 7, which is
the R default</td>
</tr>
</tbody>
</table>
<p>Each of these options allows you to set these settings in one place,
and every <strong>Tplyr</strong> table you create will inherit your
option settings as defaults. This allows your table code to be more
concise, and centralizes where you need to make an update when your code
has to be adjusted. This vignette is dedicated to helping you understand
how to leverage each of these options properly.</p>
<div class="section level2">
<h2 id="default-layer-formats">Default Layer Formats<a class="anchor" aria-label="anchor" href="#default-layer-formats"></a>
</h2>
<p>Declaring string formats and summaries that need to be performed is
one of the more verbose parts of <strong>Tplyr</strong>. Furthermore,
this is something that will often be fairly consistent within a study,
as you’ll likely want to look across a consistent set of descriptive
statistics, or your count/shift tables will likely require the same sort
of “n (%)” formatting.</p>
<p>Using the format options is very similar to setting a string format.
The only difference is that you need to enter the string formats as a
named list instead of as separate parameters to a function call.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span></span>
<span>    <span class="co"># Count layer defaults</span></span>
<span>  tplyr.count_layer_default_formats <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n_counts <span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">"xxx (xx%)"</span>, <span class="va">n</span>, <span class="va">pct</span><span class="op">)</span>,</span>
<span>         riskdiff <span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">'xx.xxx'</span>, <span class="va">dif</span><span class="op">)</span></span>
<span>         <span class="op">)</span>,</span>
<span></span>
<span>  <span class="co"># Desc layer defaults</span></span>
<span>  tplyr.desc_layer_default_formats <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"n"</span>        <span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">"xxx"</span>, <span class="va">n</span><span class="op">)</span>,</span>
<span>         <span class="st">"Mean (SD)"</span><span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">"a.a+1 (a.a+2)"</span>, <span class="va">mean</span>, <span class="va">sd</span><span class="op">)</span>,</span>
<span>         <span class="st">"Median"</span>   <span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">"a.a+4"</span>, <span class="va">median</span><span class="op">)</span></span>
<span>         <span class="op">)</span>,</span>
<span></span>
<span>  <span class="co"># Shift layer defaults</span></span>
<span>  tplyr.shift_layer_default_formats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">"xxx"</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span> </span></code></pre></div>
<p>Here you can see that <strong>Tplyr</strong> picks up these option
changes. In the table below, we didn’t use
<code><a href="../reference/set_format_strings.html">set_format_strings()</a></code> anywhere - instead we let
<strong>Tplyr</strong> pick up the default formats from the options.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span><span class="op">(</span><span class="va">adsl</span>, <span class="va">TRT01P</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/layer_constructors.html">group_desc</a></span><span class="op">(</span><span class="va">AGE</span>, by <span class="op">=</span> <span class="st">"Age (years)"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span><span class="op">(</span><span class="va">AGEGR1</span>, by <span class="op">=</span> <span class="st">"Categorical Age Groups"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/build.html">build</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="16%">
<col width="7%">
<col width="9%">
<col width="18%">
<col width="18%">
<col width="11%">
<col width="8%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">row_label2</th>
<th align="left">var1_Placebo</th>
<th align="left">var1_Xanomeline High Dose</th>
<th align="left">var1_Xanomeline Low Dose</th>
<th align="right">ord_layer_index</th>
<th align="right">ord_layer_1</th>
<th align="right">ord_layer_2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Age (years)</td>
<td align="left">n</td>
<td align="left">86</td>
<td align="left">84</td>
<td align="left">84</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Age (years)</td>
<td align="left">Mean (SD)</td>
<td align="left">75.2 ( 8.59)</td>
<td align="left">74.4 ( 7.89)</td>
<td align="left">75.7 ( 8.29)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Age (years)</td>
<td align="left">Median</td>
<td align="left">76.0</td>
<td align="left">76.0</td>
<td align="left">77.5</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">Age (years)</td>
<td align="left">Q1, Q3</td>
<td align="left">69.2, 81.8</td>
<td align="left">70.8, 80.0</td>
<td align="left">71.0, 82.0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">Age (years)</td>
<td align="left">Min, Max</td>
<td align="left">52, 89</td>
<td align="left">56, 88</td>
<td align="left">51, 88</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">Age (years)</td>
<td align="left">Missing</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Categorical Age Groups</td>
<td align="left">&lt;65</td>
<td align="left">14 ( 16.3%)</td>
<td align="left">11 ( 13.1%)</td>
<td align="left">8 ( 9.5%)</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Categorical Age Groups</td>
<td align="left">&gt;80</td>
<td align="left">30 ( 34.9%)</td>
<td align="left">18 ( 21.4%)</td>
<td align="left">29 ( 34.5%)</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Categorical Age Groups</td>
<td align="left">65-80</td>
<td align="left">42 ( 48.8%)</td>
<td align="left">55 ( 65.5%)</td>
<td align="left">47 ( 56.0%)</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<p>One important thing to understand about how these options work in
particular is the scoping.</p>
<ul>
<li>
<strong>Tplyr</strong> options have the broadest scope, as they work
across the entire session for any table.</li>
<li>Setting formats at the <code><a href="../reference/tplyr_table.html">tplyr_table()</a></code> level will
override the <strong>Tplyr</strong> options and extends to any layer of
the specified type in the current table.</li>
<li>Setting formats at the <code><a href="../reference/tplyr_layer.html">tplyr_layer()</a></code> level will always
be prioritized over <strong>Tplyr</strong> options and any
<code><a href="../reference/tplyr_table.html">tplyr_table()</a></code> formats set. This has the narrowest scope and
will always be used when specified.</li>
</ul>
<p>To demonstrate, consider the following. The <strong>Tplyr</strong>
options remain set from the block above.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span><span class="op">(</span><span class="va">adsl</span>, <span class="va">TRT01P</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/table_format_defaults.html">set_count_layer_formats</a></span><span class="op">(</span>n_counts <span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">"xx (xxx%)"</span>, <span class="va">n</span>, <span class="va">pct</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/table_format_defaults.html">set_desc_layer_formats</a></span><span class="op">(</span><span class="st">"Mean (SD)"</span> <span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">"a.a+1 (a.a+2)"</span>, <span class="va">mean</span>, <span class="va">sd</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/layer_constructors.html">group_desc</a></span><span class="op">(</span><span class="va">AGE</span>, by <span class="op">=</span> <span class="st">"Age (Years)"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span><span class="op">(</span><span class="va">AGEGR1</span>, by <span class="op">=</span> <span class="st">"Categorical Age Groups"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span><span class="op">(</span><span class="va">ETHNIC</span>, by <span class="op">=</span> <span class="st">"Ethnicity"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="../reference/set_format_strings.html">set_format_strings</a></span><span class="op">(</span><span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">"xxxxx (xx.xxx%)"</span>, <span class="va">n</span>, <span class="va">pct</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/build.html">build</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="15%">
<col width="15%">
<col width="8%">
<col width="17%">
<col width="16%">
<col width="10%">
<col width="8%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">row_label2</th>
<th align="left">var1_Placebo</th>
<th align="left">var1_Xanomeline High Dose</th>
<th align="left">var1_Xanomeline Low Dose</th>
<th align="right">ord_layer_index</th>
<th align="right">ord_layer_1</th>
<th align="right">ord_layer_2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Age (Years)</td>
<td align="left">Mean (SD)</td>
<td align="left">75.2 ( 8.59)</td>
<td align="left">74.4 ( 7.89)</td>
<td align="left">75.7 ( 8.29)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Categorical Age Groups</td>
<td align="left">&lt;65</td>
<td align="left">14 ( 16%)</td>
<td align="left">11 ( 13%)</td>
<td align="left">8 ( 10%)</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Categorical Age Groups</td>
<td align="left">&gt;80</td>
<td align="left">30 ( 35%)</td>
<td align="left">18 ( 21%)</td>
<td align="left">29 ( 35%)</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Categorical Age Groups</td>
<td align="left">65-80</td>
<td align="left">42 ( 49%)</td>
<td align="left">55 ( 65%)</td>
<td align="left">47 ( 56%)</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">Ethnicity</td>
<td align="left">HISPANIC OR LATINO</td>
<td align="left">3 ( 3.488%)</td>
<td align="left">3 ( 3.571%)</td>
<td align="left">6 ( 7.143%)</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Ethnicity</td>
<td align="left">NOT HISPANIC OR LATINO</td>
<td align="left">83 (96.512%)</td>
<td align="left">81 (96.429%)</td>
<td align="left">78 (92.857%)</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<p>In the above output:</p>
<ul>
<li>The descriptive statistics layer for “Age (Years)” uses the
specified table default using <code><a href="../reference/table_format_defaults.html">set_desc_layer_formats()</a></code>
</li>
<li>The first count layer for “Categorical Age Groups” uses the
specified table default using
<code><a href="../reference/table_format_defaults.html">set_count_layer_formats()</a></code>
</li>
<li>The second count layer for “Ethnicity” uses the layer level format
specified using <code><a href="../reference/set_format_strings.html">set_format_strings()</a></code>
</li>
</ul>
<p>Each of the outputs ignores the <strong>Tplyr</strong> option
defaults.</p>
</div>
<div class="section level2">
<h2 id="precision-cap">Precision Cap<a class="anchor" aria-label="anchor" href="#precision-cap"></a>
</h2>
<p><strong>Tplyr</strong> defaults to avoiding capping precision. We do
this because capping precision should be a conscious decision, where you
as the user specifically set the limit of how many decimal places are
relevant to a specific result. One way to cap precision is by using the
<code>cap</code> parameter within <code><a href="../reference/set_format_strings.html">set_format_strings()</a></code>. But
perhaps you have a specific limit to what you’d like to see on any
output. Here, we offer the <code>tplyr.precision_cap</code> option to
set whatever cap you wish.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>tplyr.precision_cap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'int'</span><span class="op">=</span><span class="fl">2</span>, <span class="st">'dec'</span><span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Similar to the layer defaults, setting a precision cap at the layer
level will override the <code>tplyr.precision_cap</code> option.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span><span class="op">(</span><span class="va">adsl</span>, <span class="va">TRT01P</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/layer_constructors.html">group_desc</a></span><span class="op">(</span><span class="va">HEIGHTBL</span>, by <span class="op">=</span> <span class="st">"Height at Baseline"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="../reference/set_format_strings.html">set_format_strings</a></span><span class="op">(</span></span>
<span>        <span class="st">'Mean (SD)'</span> <span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">'a.a (a.a+1)'</span>, <span class="va">mean</span>, <span class="va">sd</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/layer_constructors.html">group_desc</a></span><span class="op">(</span><span class="va">HEIGHTBL</span>, by <span class="op">=</span> <span class="st">"Height at Baseline (Limited)"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="../reference/set_format_strings.html">set_format_strings</a></span><span class="op">(</span></span>
<span>        <span class="st">'Mean (SD)'</span> <span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">'a.a (a.a+1)'</span>, <span class="va">mean</span>, <span class="va">sd</span><span class="op">)</span>,</span>
<span>        cap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'int'</span><span class="op">=</span> <span class="fl">1</span>, <span class="st">'dec'</span><span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/build.html">build</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="20%">
<col width="7%">
<col width="9%">
<col width="17%">
<col width="17%">
<col width="11%">
<col width="8%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">row_label2</th>
<th align="left">var1_Placebo</th>
<th align="left">var1_Xanomeline High Dose</th>
<th align="left">var1_Xanomeline Low Dose</th>
<th align="right">ord_layer_index</th>
<th align="right">ord_layer_1</th>
<th align="right">ord_layer_2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Height at Baseline</td>
<td align="left">Mean (SD)</td>
<td align="left">162.6 (11.52)</td>
<td align="left">165.8 (10.13)</td>
<td align="left">163.4 (10.42)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Height at Baseline (Limited)</td>
<td align="left">Mean (SD)</td>
<td align="left">163 (11.5)</td>
<td align="left">166 (10.1)</td>
<td align="left">163 (10.4)</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>Both layers in the above example are summarizing the same data. The
top layer is using the <code>tplyr.precision_cap</code> option set
above, which limits to 2 integer place and 2 decimal places. To bottom
layer applies its own cap to override the option. Recall a few things
about auto precision:</p>
<ul>
<li>Integers will not be truncated - rather, the auto precision will
default how much padding should be applied. If the number exceeds that
number of spaces, then the length will be extended (i.e. if 2 integer
places are allotted, 100 will still consume 3 places).</li>
<li>The cap applies to the spaces allotted by the ‘a’. If the cap is 2,
‘a+1’ will not exceed 3 spaces.</li>
</ul>
<p>The bottom layer overrides the <strong>Tplyr</strong> option.
Instead, integers are capped at 1 space, and decimals are capped at
0.</p>
</div>
<div class="section level2">
<h2 id="custom-summaries">Custom Summaries<a class="anchor" aria-label="anchor" href="#custom-summaries"></a>
</h2>
<p>Custom summaries allow you to extend the capabilities of descriptive
statistics layers in <strong>Tplyr</strong>. Maybe our defaults don’t
work how you’d like them to, or maybe you have some custom functions
within your organization that you commonly would like to use. Specifying
the custom summaries you wish to use in every table would prove quite
tedious - therefore, the <code>tplyr.custom_summaries</code> option is a
better choice.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>tplyr.custom_summaries <span class="op">=</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">quos</a></span><span class="op">(</span></span>
<span>  geometric_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">.var</span><span class="op">[</span><span class="va">.var</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">.var</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Note that the table code used to produce the output is the same. Now
<strong>Tplyr</strong> used the custom summary function for
<code>geometric_mean</code> as specified in the
<code>tplyr.custom_summaries</code> option. Also note the use of
<code><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">rlang::quos()</a></code>. We’ve done our best to mask this from the
user everywhere possible and make the interfaces clean and intuitive,
but a great deal of <strong>Tplyr</strong> is built using ‘rlang’ and
non-standard evaluation. Within this option is one of the very few
instances where a user needs to concern themselves with the use of
quosures. If you’d like to learn more about non-standard evaluation and
quosures, we recommend <a href="https://adv-r.hadley.nz/metaprogramming.html" class="external-link">Section IV</a> in
Advanced R.</p>
<p>Now that geometric mean is set within the <strong>Tplyr</strong>
options, you can use it within your descriptive statistics layers, just
like it was one of the built-in summaries.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span><span class="op">(</span><span class="va">adsl</span>, <span class="va">TRT01P</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/layer_constructors.html">group_desc</a></span><span class="op">(</span><span class="va">AGE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="../reference/set_format_strings.html">set_format_strings</a></span><span class="op">(</span><span class="st">'Geometric Mean'</span> <span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">'xx.xx'</span>, <span class="va">geometric_mean</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/build.html">build</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="14%">
<col width="12%">
<col width="24%">
<col width="23%">
<col width="14%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">var1_Placebo</th>
<th align="left">var1_Xanomeline High Dose</th>
<th align="left">var1_Xanomeline Low Dose</th>
<th align="right">ord_layer_index</th>
<th align="right">ord_layer_1</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">Geometric Mean</td>
<td align="left">74.70</td>
<td align="left">73.94</td>
<td align="left">75.18</td>
<td align="right">1</td>
<td align="right">1</td>
</tr></tbody>
</table>
</div>
<div class="section level2">
<h2 id="scientific-notation">Scientific Notation<a class="anchor" aria-label="anchor" href="#scientific-notation"></a>
</h2>
<p>By default, R will switch to scientific notation for a number less
than .001. This is controlled by the <code>scipen</code> option. The
default value of <code>scipen</code> is 0. If you’d like to increase the
decimal places required for scientific notation to be triggered,
increase the value of <code>scipen</code>. The value of
<code>scipen</code> is the number of orders of ten smaller (i.e. decimal
places preceded by 0’s) required to switch to scientific notation.
Decreasing the value of <code>scipen</code> will cause R to switch to
scientific location for larger numbers.</p>
<p>This is easier to understand with an example.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>scipen <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># This is the default</span></span>
<span><span class="fl">.0001</span></span>
<span><span class="co">#&gt; [1] 1e-04</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>scipen <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># Require 5 decimal places instead</span></span>
<span></span>
<span><span class="fl">.0001</span></span>
<span><span class="co">#&gt; [1] 0.0001</span></span>
<span><span class="fl">.00001</span></span>
<span><span class="co">#&gt; [1] 1e-05</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>scipen <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="co"># Only require 3 decimal places</span></span>
<span><span class="fl">.001</span></span>
<span><span class="co">#&gt; [1] 1e-03</span></span></code></pre></div>
<p>In <strong>Tplyr</strong>, we have the option
<code>tplyr.scipen</code>. This is the <code>scipen</code> setting that
will be used <em>only</em> while the <strong>Tplyr</strong> table is
being built. This allows you to use a different <code>scipen</code>
setting within <strong>Tplyr</strong> than your R session. The default
value we use in <strong>Tplyr</strong> is 9999, which is intended to
totally prevent numbers from switching to scientific notation. We want
this to be a conscious decision that you make in order to prevent any
unexpected outputs.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>tplyr.scipen <span class="op">=</span> <span class="op">-</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span><span class="op">(</span><span class="va">adae</span>, <span class="va">TRTA</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span><span class="op">(</span><span class="va">AEDECOD</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="../reference/add_risk_diff.html">add_risk_diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Xanomeline Low Dose'</span>, <span class="st">'Placebo'</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/build.html">build</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># Chi-squared warnings occur with small samples</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="13%">
<col width="8%">
<col width="17%">
<col width="17%">
<col width="11%">
<col width="23%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">var1_Placebo</th>
<th align="left">var1_Xanomeline High Dose</th>
<th align="left">var1_Xanomeline Low Dose</th>
<th align="right">ord_layer_index</th>
<th align="left">rdiff_Xanomeline Low Dose_Placebo</th>
<th align="right">ord_layer_1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ACTINIC KERATOSIS</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 (9e-01%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="right">1</td>
<td align="left">0.000 ( 0.000, 0.000)</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">ALOPECIA</td>
<td align="left">1 ( 2.1%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="right">1</td>
<td align="left">-2.1e-02 (-7.7e-02, 3.5e-02)</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">BLISTER</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">2 ( 1.8%)</td>
<td align="left">8 ( 6.8%)</td>
<td align="right">1</td>
<td align="left">6.8e-02 ( 8e-03, 0.128)</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">COLD SWEAT</td>
<td align="left">3 ( 6.4%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="right">1</td>
<td align="left">-6.4e-02 (-0.149, 2.1e-02)</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">DERMATITIS ATOPIC</td>
<td align="left">1 ( 2.1%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="right">1</td>
<td align="left">-2.1e-02 (-7.7e-02, 3.5e-02)</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">DERMATITIS CONTACT</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">2 ( 1.7%)</td>
<td align="right">1</td>
<td align="left">1.7e-02 (-2.1e-02, 5.5e-02)</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
<p>Note that the risk-difference variables above have mostly shifted to
scientific notation. This is because the limit has been shifted to .1
within the <strong>Tplyr</strong> build.</p>
</div>
<div class="section level2">
<h2 id="quantile-algorithms">Quantile Algorithms<a class="anchor" aria-label="anchor" href="#quantile-algorithms"></a>
</h2>
<p>There are many algorithms available to compute quantile R has 9,
controlled by the <code>type</code> parameter in
<code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile()</a></code>. The descriptive statistics offer built-in
summaries for Q1, Q3, and Interquartile range, all three of which use
the <code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile()</a></code> in the underlying implementation. Given that
we offer this default, we felt it was important to offer you the
flexibility to change the algorithm. You can do this with
<code>tplyr.quantile_type</code>.</p>
<p>The default we chose to use is the R default of Type 7:</p>
<p><span class="math display">\[
m = 1-p. p[k] = (k - 1) / (n - 1). \textrm{In this case, } p[k] =
mode[F(x[k])]. \textrm{This is used by S.}
\]</span> The example below demonstrates using the default quantile
algorithm in R</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span><span class="op">(</span><span class="va">adsl</span>, <span class="va">TRT01P</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/layer_constructors.html">group_desc</a></span><span class="op">(</span><span class="va">CUMDOSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="../reference/set_format_strings.html">set_format_strings</a></span><span class="op">(</span><span class="st">"Q1, Q3"</span> <span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">'xxxxx, xxxxx'</span>, <span class="va">q1</span>, <span class="va">q3</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/build.html">build</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="10%">
<col width="12%">
<col width="25%">
<col width="24%">
<col width="15%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">var1_Placebo</th>
<th align="left">var1_Xanomeline High Dose</th>
<th align="left">var1_Xanomeline Low Dose</th>
<th align="right">ord_layer_index</th>
<th align="right">ord_layer_1</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">Q1, Q3</td>
<td align="left">0, 0</td>
<td align="left">2646, 13959</td>
<td align="left">1984, 9801</td>
<td align="right">1</td>
<td align="right">1</td>
</tr></tbody>
</table>
<p>Within the clinical world, you may wish to match the way that SAS
calculates quantiles. To match SAS’s definition, use Type 3:</p>
<p><span class="math display">\[
\textrm{Nearest even order statistic. γ = 0 if g = 0 and  j is even, and
1 otherwise.}
\]</span></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>tplyr.quantile_type <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span><span class="op">(</span><span class="va">adsl</span>, <span class="va">TRT01P</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/layer_constructors.html">group_desc</a></span><span class="op">(</span><span class="va">CUMDOSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="../reference/set_format_strings.html">set_format_strings</a></span><span class="op">(</span><span class="st">"Q1, Q3"</span> <span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">'xxxxx, xxxxx'</span>, <span class="va">q1</span>, <span class="va">q3</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/build.html">build</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"ord"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="14%">
<col width="17%">
<col width="34%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">var1_Placebo</th>
<th align="left">var1_Xanomeline High Dose</th>
<th align="left">var1_Xanomeline Low Dose</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">Q1, Q3</td>
<td align="left">0, 0</td>
<td align="left">2565, 13959</td>
<td align="left">1944, 9774</td>
</tr></tbody>
</table>
</div>
<div class="section level2">
<h2 id="ibm-rounding">IBM Rounding<a class="anchor" aria-label="anchor" href="#ibm-rounding"></a>
</h2>
<p>In certain cases users may want to match tables produced by other
languages that IBM rounding.<strong>Tplyr</strong> offers the option
‘tplyr.IBMRounding’ to change the default rounding behavior of
<strong>Tplyr</strong> tables. Review var1_4 in the tables below.</p>
<p>Using the default R behavior</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">gear</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/layer_constructors.html">group_desc</a></span><span class="op">(</span><span class="va">qsec</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="../reference/set_format_strings.html">set_format_strings</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">"xx.xx"</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/build.html">build</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">#&gt;   row_label1 var1_3 var1_4 var1_5 ord_layer_index ord_layer_1</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> mean       17.69  18.96  15.64                1           1</span></span></code></pre></div>
<p>Using IBM rounding</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_options.html" class="external-link">with_options</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>tplyr.IBMRounding <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">gear</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="../reference/layer_constructors.html">group_desc</a></span><span class="op">(</span><span class="va">qsec</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>          <span class="fu"><a href="../reference/set_format_strings.html">set_format_strings</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span><span class="op">(</span><span class="st">"xx.xx"</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="../reference/build.html">build</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: You have enabled IBM Rounding. This is an experimental feature.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span>  If you have feedback please get in touch with the maintainers!</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">#&gt;   row_label1 var1_3 var1_4 var1_5 ord_layer_index ord_layer_1</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> mean       17.69  18.97  15.64                1           1</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Eli Miller, Mike Stackhouse, Ashley Tarasiewicz, Nathan Kosiba.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
