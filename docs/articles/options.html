<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tplyr Options • Tplyr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Tplyr Options">
<meta property="og:description" content="Tplyr">
<meta property="og:image" content="/reference/figures/Atorus_Stickers_vF_Tplyr.png">
<meta property="og:image:alt" content="Tplyr Hex Sticker">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@AtorusR">
<meta name="twitter:site" content="@AtorusR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Tplyr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Tplyr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-header">Table Vignettes</li>
    <li>
      <a href="../articles/table.html">Tplyr Table Properties</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Layer Vignettes</li>
    <li>
      <a href="../articles/desc.html">Descriptive Statistic Layers</a>
    </li>
    <li>
      <a href="../articles/count_shift.html">Count and Shift Tables</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Helpers</li>
    <li>
      <a href="../articles/riskdiff.html">Risk Difference</a>
    </li>
    <li>
      <a href="../articles/sort.html">Sorting a Tplyr Table</a>
    </li>
    <li>
      <a href="../articles/options.html">Tplyr Options</a>
    </li>
    <li>
      <a href="../articles/styled-table.html">Producing a Styled Table</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/atorus-research/Tplyr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Tplyr Options</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/atorus-research/Tplyr/blob/master/vignettes/options.Rmd"><code>vignettes/options.Rmd</code></a></small>
      <div class="hidden name"><code>options.Rmd</code></div>

    </div>

    
    
<p>One thing that we wanted to build into ‘Tplyr’ to make it a user friendly package is the ability to eliminate redundant code where possible. This is why there are several options available in ‘Tplyr’ to allow you to control things at your session level instead of each individual table, or even each individual layer.</p>
<p>The following are the options available in ‘Tplyr’ and their descriptions:</p>
<table class="table">
<thead><tr class="header">
<th align="center">Option</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">tplyr.count_layer_default_formats</td>
<td align="left">The default format strings for a count layer. Defaults to an auto-calculated n width, and (xxx.x%) for distinct counts (if available - non-distinct counts are used otherwise). Risk difference formats default to dif (low CI, high CI), all with 2 integer spaces and 3 decimal places.</td>
</tr>
<tr class="even">
<td align="center">tplyr.shift_layer_default_formats</td>
<td align="left">The default shift layer format. Defaults to an auto-calculated n width.</td>
</tr>
<tr class="odd">
<td align="center">tplyr.desc_layer_default_formats</td>
<td align="left">The default descriptive statistics layer format. Defaults to “n”, “Mean (SD)”, “Median”, “Q1, Q3”, “Min, Max”, and “Missing”. Everything except “n” and “Missing” use auto-precision. Mean, Q1, Q3, and median defaults to +1 decimal places and Standard Deviation defaults to +2.</td>
</tr>
<tr class="even">
<td align="center">tplyr.precision_cap</td>
<td align="left">The default precision cap for auto-precision. Both integer and decimal places default to 99, essentially ensuring that precision is not capped by default.</td>
</tr>
<tr class="odd">
<td align="center">tplyr.custom_summaries</td>
<td align="left">Default custom summaries available to Tplyr. Defaults to NULL, as Tplyr’s defaults are seen as built-ins and not custom summaries.</td>
</tr>
<tr class="even">
<td align="center">tplyr.scipen</td>
<td align="left">The default ‘scipen’ setting used while Tplyr is executing. Defaults to 1000. See the R documentation on the ‘scipen’ option to understand more, but this allows you to control how small a number must be before scientific notation is used when a number is string formatted in presentation.</td>
</tr>
<tr class="odd">
<td align="center">tplyr.quantile_type</td>
<td align="left">The default quantile algorithm used by Tpylr when using the built-in summaries for Q1, Q3, and IQR. Defaults to Type 7, which is the R default</td>
</tr>
</tbody>
</table>
<p>Each of these options allows you to set these settings in one place, and every ‘Tplyr’ table you create will inherit your option settings as defaults. This allows your table code to be more concise, and centralize where you need to make an update when your code has to be adjusted. This vignette is dedicated to helping you understand how to leverage each of these options properly.</p>
<div id="default-layer-formats" class="section level2">
<h2 class="hasAnchor">
<a href="#default-layer-formats" class="anchor"></a>Default Layer Formats</h2>
<p>Declaring string formats and summaries that need to be performed is one of the more verbose parts of ‘Tplyr’. Furthermore, this is something that will often be fairly consistent within a study, as you’ll likely want to look across a consistent set of descriptive statistics, or your count/shift tables will likely require the same sort of “n (%)” formatting.</p>
<p>Using the format options is very similar to setting a string format. The only difference is that you need to enter the string formats as a named list instead of as separate parameters to a function call.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(
    <span class="co"># Count layer defaults</span>
  <span class="kw">tplyr.count_layer_default_formats</span> <span class="kw">=</span>
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">n_counts</span> <span class="kw">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">"xxx (xx%)"</span>, <span class="no">n</span>, <span class="no">pct</span>),
         <span class="kw">riskdiff</span> <span class="kw">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">'xx.xxx'</span>, <span class="no">dif</span>)
         ),

  <span class="co"># Desc layer defaults</span>
  <span class="kw">tplyr.desc_layer_default_formats</span> <span class="kw">=</span>
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"n"</span>        <span class="kw">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">"xxx"</span>, <span class="no">n</span>),
         <span class="st">"Mean (SD)"</span><span class="kw">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">"a.a+1 (a.a+2)"</span>, <span class="no">mean</span>, <span class="no">sd</span>),
         <span class="st">"Median"</span>   <span class="kw">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">"a.a+4"</span>, <span class="no">median</span>)
         ),

  <span class="co"># Shift layer defaults</span>
  <span class="kw">tplyr.shift_layer_default_formats</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">"xxx"</span>, <span class="no">n</span>))
)</pre></body></html></div>
<p>Here you can see that ‘Tplyr’ picks up these option changes. In the table below, we didn’t use <code><a href="../reference/set_format_strings.html">set_format_strings()</a></code> anywhere - instead we let ‘Tplyr’ pick up the default formats from the options.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adsl</span>, <span class="no">TRT01P</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_desc</a></span>(<span class="no">AGE</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="st">"Age (years)"</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span>(<span class="no">AGEGR1</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="st">"Categorical Age Groups"</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">row_label2</th>
<th align="left">var1_Placebo</th>
<th align="left">var1_Xanomeline High Dose</th>
<th align="left">var1_Xanomeline Low Dose</th>
<th align="right">ord_layer_index</th>
<th align="right">ord_layer_1</th>
<th align="right">ord_layer_2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Age (years)</td>
<td align="left">n</td>
<td align="left">86</td>
<td align="left">84</td>
<td align="left">84</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Age (years)</td>
<td align="left">Mean (SD)</td>
<td align="left">75.2 ( 8.59)</td>
<td align="left">74.4 ( 7.89)</td>
<td align="left">75.7 ( 8.29)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Age (years)</td>
<td align="left">Median</td>
<td align="left">76.0</td>
<td align="left">76.0</td>
<td align="left">77.5</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">Age (years)</td>
<td align="left">Q1, Q3</td>
<td align="left">69.2, 81.8</td>
<td align="left">70.8, 80.0</td>
<td align="left">71.0, 82.0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">Age (years)</td>
<td align="left">Min, Max</td>
<td align="left">52, 89</td>
<td align="left">56, 88</td>
<td align="left">51, 88</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">Age (years)</td>
<td align="left">Missing</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Categorical Age Groups</td>
<td align="left">&lt;65</td>
<td align="left">14 ( 16.3%)</td>
<td align="left">11 ( 13.1%)</td>
<td align="left">8 ( 9.5%)</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Categorical Age Groups</td>
<td align="left">&gt;80</td>
<td align="left">30 ( 34.9%)</td>
<td align="left">18 ( 21.4%)</td>
<td align="left">29 ( 34.5%)</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Categorical Age Groups</td>
<td align="left">65-80</td>
<td align="left">42 ( 48.8%)</td>
<td align="left">55 ( 65.5%)</td>
<td align="left">47 ( 56.0%)</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<p>One important thing to understand about how these options work in particular is the scoping.</p>
<ul>
<li>‘Tplyr’ options have the broadest scope, as they work across the entire session for any table.</li>
<li>Setting formats at the <code><a href="../reference/tplyr_table.html">tplyr_table()</a></code> level will override the ‘Tplyr’ options and extends to any layer of the specified type in the current table.</li>
<li>Setting formats at the <code><a href="../reference/tplyr_layer.html">tplyr_layer()</a></code> level will always be prioritized over ‘Tplyr’ options and any <code><a href="../reference/tplyr_table.html">tplyr_table()</a></code> formats set. This has the narrowest scope and will always be used when specified.</li>
</ul>
<p>To demonstrate, consider the following. The ‘Tplyr’ options remain set from the block above.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adsl</span>, <span class="no">TRT01P</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/table_format_defaults.html">set_count_layer_formats</a></span>(<span class="kw">n_counts</span> <span class="kw">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">"xx (xxx%)"</span>, <span class="no">n</span>, <span class="no">pct</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/table_format_defaults.html">set_desc_layer_formats</a></span>(<span class="st">"Mean (SD)"</span> <span class="kw">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">"a.a+1 (a.a+2)"</span>, <span class="no">mean</span>, <span class="no">sd</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_desc</a></span>(<span class="no">AGE</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="st">"Age (Years)"</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span>(<span class="no">AGEGR1</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="st">"Categorical Age Groups"</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span>(<span class="no">ETHNIC</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="st">"Ethnicity"</span>) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/set_format_strings.html">set_format_strings</a></span>(<span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">"xxxxx (xx.xxx%)"</span>, <span class="no">n</span>, <span class="no">pct</span>))
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">row_label2</th>
<th align="left">var1_Placebo</th>
<th align="left">var1_Xanomeline High Dose</th>
<th align="left">var1_Xanomeline Low Dose</th>
<th align="right">ord_layer_index</th>
<th align="right">ord_layer_1</th>
<th align="right">ord_layer_2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Age (Years)</td>
<td align="left">Mean (SD)</td>
<td align="left">75.2 ( 8.59)</td>
<td align="left">74.4 ( 7.89)</td>
<td align="left">75.7 ( 8.29)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Categorical Age Groups</td>
<td align="left">&lt;65</td>
<td align="left">14 ( 16%)</td>
<td align="left">11 ( 13%)</td>
<td align="left">8 ( 10%)</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Categorical Age Groups</td>
<td align="left">&gt;80</td>
<td align="left">30 ( 35%)</td>
<td align="left">18 ( 21%)</td>
<td align="left">29 ( 35%)</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Categorical Age Groups</td>
<td align="left">65-80</td>
<td align="left">42 ( 49%)</td>
<td align="left">55 ( 65%)</td>
<td align="left">47 ( 56%)</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">Ethnicity</td>
<td align="left">HISPANIC OR LATINO</td>
<td align="left">3 ( 3.488%)</td>
<td align="left">3 ( 3.571%)</td>
<td align="left">6 ( 7.143%)</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Ethnicity</td>
<td align="left">NOT HISPANIC OR LATINO</td>
<td align="left">83 (96.512%)</td>
<td align="left">81 (96.429%)</td>
<td align="left">78 (92.857%)</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<p>In the above output:</p>
<ul>
<li>The descriptive statistics layer for “Age (Years)” uses the specified table default using <code><a href="../reference/table_format_defaults.html">set_desc_layer_formats()</a></code>
</li>
<li>The first count layer for “Categorical Age Groups” uses the specified table default using <code><a href="../reference/table_format_defaults.html">set_count_layer_formats()</a></code>
</li>
<li>The second count layer for “Ethnicity” uses the layer level format specified using <code><a href="../reference/set_format_strings.html">set_format_strings()</a></code>
</li>
</ul>
<p>Each of the outputs ignores the ‘Tpylr’ option defaults.</p>
</div>
<div id="precision-cap" class="section level2">
<h2 class="hasAnchor">
<a href="#precision-cap" class="anchor"></a>Precision Cap</h2>
<p>‘Tplyr’ defaults to avoiding capping precision. We do this because capping precision should be a conscious decision, where you as the user specifically set the limit of how many decimal places are relevant to a specific result. One way to cap precision is by using the <code>cap</code> parameter within <code><a href="../reference/set_format_strings.html">set_format_strings()</a></code>. But perhaps you have a specific limit to what you’d like to see on any output. Here, we offer the <code>tplyr.precision_cap</code> option to set whatever cap you wish.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="kw">tplyr.precision_cap</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'int'</span><span class="kw">=</span><span class="fl">2</span>, <span class="st">'dec'</span><span class="kw">=</span><span class="fl">2</span>))</pre></body></html></div>
<p>Similar to the layer defaults, setting a precision cap at the layer level will override the <code>tplyr.precision_cap</code> option.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adsl</span>, <span class="no">TRT01P</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_desc</a></span>(<span class="no">HEIGHTBL</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="st">"Height at Baseline"</span>) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/set_format_strings.html">set_format_strings</a></span>(
        <span class="st">'Mean (SD)'</span> <span class="kw">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">'a.a (a.a+1)'</span>, <span class="no">mean</span>, <span class="no">sd</span>)
      )
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_desc</a></span>(<span class="no">HEIGHTBL</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="st">"Height at Baseline (Limited)"</span>) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/set_format_strings.html">set_format_strings</a></span>(
        <span class="st">'Mean (SD)'</span> <span class="kw">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">'a.a (a.a+1)'</span>, <span class="no">mean</span>, <span class="no">sd</span>),
        <span class="kw">cap</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'int'</span><span class="kw">=</span> <span class="fl">1</span>, <span class="st">'dec'</span><span class="kw">=</span><span class="fl">0</span>)
      )
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">row_label2</th>
<th align="left">var1_Placebo</th>
<th align="left">var1_Xanomeline High Dose</th>
<th align="left">var1_Xanomeline Low Dose</th>
<th align="right">ord_layer_index</th>
<th align="right">ord_layer_1</th>
<th align="right">ord_layer_2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Height at Baseline</td>
<td align="left">Mean (SD)</td>
<td align="left">162.6 (11.52)</td>
<td align="left">165.8 (10.13)</td>
<td align="left">163.4 (10.42)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Height at Baseline (Limited)</td>
<td align="left">Mean (SD)</td>
<td align="left">163 (11.5)</td>
<td align="left">166 (10.1)</td>
<td align="left">163 (10.4)</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>Both layers in the above example are summarizing the same data. The top layer is using the <code>tplyr.precision_cap</code> option set above, which limits to 2 integer place and 2 decimal places. To bottom layer applies its own cap to override the option. Recall a few things about auto precision:</p>
<ul>
<li>Integers will not be truncated - rather, the auto precision will default how much padding should be applied. If the number exceeds that number of spaces, then the length will be extended (i.e. if 2 integer places are allotted, 100 will still consume 3 places).</li>
<li>The cap applies to the spaces allotted by the ‘a’. If the cap is 2, ‘a+1’ will not exceed 3 spaces.</li>
</ul>
<p>The bottom layer overrides the ‘Tplyr’ option. Instead, integers are capped at 1 space, and decimals are capped at 0.</p>
</div>
<div id="custom-summaries" class="section level2">
<h2 class="hasAnchor">
<a href="#custom-summaries" class="anchor"></a>Custom Summaries</h2>
<p>Custom summaries allow you to extend the capabilities of descriptive statistics layers in ‘Tplyr’. Maybe our defaults don’t work how you’d like them to, or maybe you have some custom functions within your organization that you commonly would like to use. Specifying the custom summaries you wish to use in every table would prove quite tedious - therefore, the <code>tplyr.custom_summaries</code> option is a better choice.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="kw">tplyr.custom_summaries</span> <span class="kw">=</span> <span class="kw pkg">rlang</span><span class="kw ns">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/nse-defuse.html">quos</a></span>(
  <span class="kw">geometric_mean</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">.var</span>[<span class="no">.var</span> <span class="kw">&gt;</span> <span class="fl">0</span>]),<span class="kw">na.rm</span><span class="kw">=</span><span class="fl">TRUE</span>) / <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">.var</span>))
))</pre></body></html></div>
<p>Note that the table code used to produce the output is the same. Now ‘Tplyr’ used the custom summary function for <code>geometric_mean</code> as specified in the <code>tplyr.custom_summaries</code> option. Also note the use of <code><a href="https://rlang.r-lib.org/reference/nse-defuse.html">rlang::quos()</a></code>. We’ve done our best to mask this from the user everywhere possible and make the interfaces clean and intuitive, but a great deal of ‘Tplyr’ is built using ‘rlang’ and non-standard evaluation. Within this option is one of the very few instances where a user needs to concern themselves with the use of quosures. If you’d like to learn more about non-standard evaluation and quosures, we recommend <a href="https://adv-r.hadley.nz/metaprogramming.html">Section IV</a> in Advanced R.</p>
<p>Now that geometric mean is set within the ‘Tplyr’ options, you can use it within your descriptive statistics layers, just like it was one of the built-in summaries.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adsl</span>, <span class="no">TRT01P</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_desc</a></span>(<span class="no">AGE</span>) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/set_format_strings.html">set_format_strings</a></span>(<span class="st">'Geometric Mean'</span> <span class="kw">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">'xx.xx'</span>, <span class="no">geometric_mean</span>))
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">var1_Placebo</th>
<th align="left">var1_Xanomeline High Dose</th>
<th align="left">var1_Xanomeline Low Dose</th>
<th align="right">ord_layer_index</th>
<th align="right">ord_layer_1</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">Geometric Mean</td>
<td align="left">74.70</td>
<td align="left">73.94</td>
<td align="left">75.18</td>
<td align="right">1</td>
<td align="right">1</td>
</tr></tbody>
</table>
</div>
<div id="scientific-notation" class="section level2">
<h2 class="hasAnchor">
<a href="#scientific-notation" class="anchor"></a>Scientific Notation</h2>
<p>By default, R will switch to scientific notation for a number less than .001. This is controlled by the <code>scipen</code> option. The default value of <code>scipen</code> is 0. If you’d like to increase the decimal places required for scientific notation to be triggered, increase the value of <code>scipen</code>. The value of <code>scipen</code> is the number of orders of ten smaller (i.e. decimal places preceded by 0’s) required to switch to scientific notation. Decreasing the value of <code>scipen</code> will cause R to switch to scientific location for larger numbers.</p>
<p>This is easier to understand with an example.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="kw">scipen</span> <span class="kw">=</span> <span class="fl">0</span>) <span class="co"># This is the default</span>
<span class="fl">.0001</span>
<span class="co">#&gt; [1] 1e-04</span>

<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="kw">scipen</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="co"># Require 5 decimal places instead</span>

<span class="fl">.0001</span>
<span class="co">#&gt; [1] 0.0001</span>
<span class="fl">.00001</span>
<span class="co">#&gt; [1] 1e-05</span>

<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="kw">scipen</span> <span class="kw">=</span> -<span class="fl">1</span>) <span class="co"># Only require 3 decimal places</span>
<span class="fl">.001</span>
<span class="co">#&gt; [1] 1e-03</span></pre></body></html></div>
<p>In ‘Tplyr’, we have the option <code>tplyr.scipen</code>. This is the <code>scipen</code> setting that will be used <em>only</em> while the ‘Tplyr’ table is being built. This allows you to use a different <code>scipen</code> setting within ‘Tplyr’ than your R session. The default value we use in ‘Tplyr’ is 9999, which is intended to totally prevent numbers from switching to scientific notation. We want this to be a conscious decision that you make in order to prevent any unexpected outputs.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="kw">tplyr.scipen</span> <span class="kw">=</span> -<span class="fl">3</span>)
<span class="no">t</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adae</span>, <span class="no">TRTA</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span>(<span class="no">AEDECOD</span>) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/add_risk_diff.html">add_risk_diff</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'Xanomeline Low Dose'</span>, <span class="st">'Placebo'</span>))
  )

<span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span>(<span class="fu"><a href="../reference/build.html">build</a></span>(<span class="no">t</span>)) <span class="kw">%&gt;%</span> <span class="co"># Chi-squared warnings occur with small samples</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">var1_Placebo</th>
<th align="left">var1_Xanomeline High Dose</th>
<th align="left">var1_Xanomeline Low Dose</th>
<th align="right">ord_layer_index</th>
<th align="left">rdiff_Xanomeline Low Dose_Placebo</th>
<th align="right">ord_layer_1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ACTINIC KERATOSIS</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 (9e-01%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="right">1</td>
<td align="left">0.000 ( 0.000, 0.000)</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">ALOPECIA</td>
<td align="left">1 ( 2.1%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="right">1</td>
<td align="left">-2.1e-02 (-7.7e-02, 3.5e-02)</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">BLISTER</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">2 ( 1.8%)</td>
<td align="left">8 ( 6.8%)</td>
<td align="right">1</td>
<td align="left">6.8e-02 ( 8e-03, 0.128)</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">COLD SWEAT</td>
<td align="left">3 ( 6.4%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="right">1</td>
<td align="left">-6.4e-02 (-0.149, 2.1e-02)</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">DERMATITIS ATOPIC</td>
<td align="left">1 ( 2.1%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="right">1</td>
<td align="left">-2.1e-02 (-7.7e-02, 3.5e-02)</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">DERMATITIS CONTACT</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">2 ( 1.7%)</td>
<td align="right">1</td>
<td align="left">1.7e-02 (-2.1e-02, 5.5e-02)</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
<p>Note that the risk-difference variables above have mostly shifted to scientific notation. This is because the limit has been shifted to .1 within the ‘Tplyr’ build.</p>
</div>
<div id="quantile-algorithms" class="section level2">
<h2 class="hasAnchor">
<a href="#quantile-algorithms" class="anchor"></a>Quantile Algorithms</h2>
<p>There are many algorithms available to compute quantile R has 9, controlled by the <code>type</code> parameter in <code><a href="https://rdrr.io/r/stats/quantile.html">quantile()</a></code>. The descriptive statistics offer built-in summaries for Q1, Q3, and Interquartile range, all three of which use the <code><a href="https://rdrr.io/r/stats/quantile.html">quantile()</a></code> in the underlying implementation. Given that we offer this default, we felt it was important to offer you the flexibility to change the algorithm. You can do this with <code>tplyr.quantile_type</code>.</p>
<p>The default we chose to use is the R default of Type 7:</p>
<p><span class="math display">\[
m = 1-p. p[k] = (k - 1) / (n - 1). \textrm{In this case, } p[k] = mode[F(x[k])]. \textrm{This is used by S.}
\]</span> The example below demonstrates using the default quantile algorithm in R</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adsl</span>, <span class="no">TRT01P</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_desc</a></span>(<span class="no">CUMDOSE</span>) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/set_format_strings.html">set_format_strings</a></span>(<span class="st">"Q1, Q3"</span> <span class="kw">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">'xxxxx, xxxxx'</span>, <span class="no">q1</span>, <span class="no">q3</span>))
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">var1_Placebo</th>
<th align="left">var1_Xanomeline High Dose</th>
<th align="left">var1_Xanomeline Low Dose</th>
<th align="right">ord_layer_index</th>
<th align="right">ord_layer_1</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">Q1, Q3</td>
<td align="left">0, 0</td>
<td align="left">2646, 13959</td>
<td align="left">1984, 9801</td>
<td align="right">1</td>
<td align="right">1</td>
</tr></tbody>
</table>
<p>Within the clinical world, you may wish to match the way that SAS calculates quantiles. To match SAS’s definition, use Type 3:</p>
<p><span class="math display">\[
\textrm{Nearest even order statistic. γ = 0 if g = 0 and  j is even, and 1 otherwise.}
\]</span></p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="kw">tplyr.quantile_type</span> <span class="kw">=</span> <span class="fl">3</span>)

<span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adsl</span>, <span class="no">TRT01P</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_desc</a></span>(<span class="no">CUMDOSE</span>) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/set_format_strings.html">set_format_strings</a></span>(<span class="st">"Q1, Q3"</span> <span class="kw">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">'xxxxx, xxxxx'</span>, <span class="no">q1</span>, <span class="no">q3</span>))
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
    <span class="fu">select</span>(-<span class="fu">starts_with</span>(<span class="st">"ord"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">var1_Placebo</th>
<th align="left">var1_Xanomeline High Dose</th>
<th align="left">var1_Xanomeline Low Dose</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">Q1, Q3</td>
<td align="left">0, 0</td>
<td align="left">2565, 13959</td>
<td align="left">1944, 9774</td>
</tr></tbody>
</table>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Eli Miller, Mike Stackhouse, Ashley Tarasiewicz, Nathan Kosiba.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
