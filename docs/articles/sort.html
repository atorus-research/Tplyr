<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sorting a Tplyr Table • Tplyr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Sorting a Tplyr Table">
<meta property="og:description" content="Tplyr">
<meta property="og:image" content="/reference/figures/Atorus_Stickers_vF_Tplyr.png">
<meta property="og:image:alt" content="Tplyr Hex Sticker">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@AtorusR">
<meta name="twitter:site" content="@AtorusR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Tplyr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Tplyr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-header">Table Vignettes</li>
    <li>
      <a href="../articles/table.html">Tplyr Table Properties</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Layer Vignettes</li>
    <li>
      <a href="../articles/desc.html">Descriptive Statistic Layers</a>
    </li>
    <li>
      <a href="../articles/count_shift.html">Count and Shift Tables</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Helpers</li>
    <li>
      <a href="../articles/riskdiff.html">Risk Difference</a>
    </li>
    <li>
      <a href="../articles/sort.html">Sorting a Tplyr Table</a>
    </li>
    <li>
      <a href="../articles/options.html">Tplyr Options</a>
    </li>
    <li>
      <a href="../articles/styled-table.html">Producing a Styled Table</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/atorus-research/Tplyr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Sorting a Tplyr Table</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/atorus-research/Tplyr/blob/master/vignettes/sort.Rmd"><code>vignettes/sort.Rmd</code></a></small>
      <div class="hidden name"><code>sort.Rmd</code></div>

    </div>

    
    
<div id="sorting-a-tplyr-table" class="section level1">
<h1 class="hasAnchor">
<a href="#sorting-a-tplyr-table" class="anchor"></a>Sorting a ‘Tplyr’ Table</h1>
<p>At surface level - sorting a table may seem easy, and in many cases it is. But in a handful of cases it can get quite tricky, with some odd situations that need to be handled carefully. For this reason, we found it necessary to dedicate an entire vignette to just sorting and handling columns output by ‘Tplyr’.</p>
<p>Let’s start by looking at an example.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">t</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adsl</span>, <span class="no">TRT01A</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/treat_grps.html">add_total_group</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/treat_grps.html">add_treat_grps</a></span>(<span class="kw">Treated</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Xanomeline Low Dose"</span>, <span class="st">"Xanomeline High Dose"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span>(<span class="no">EOSSTT</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="no">SEX</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_desc</a></span>(<span class="no">HEIGHTBL</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="no">SEX</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>()

<span class="fu">kable</span>(<span class="no">t</span>)</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">row_label2</th>
<th align="left">var1_Placebo</th>
<th align="left">var1_Total</th>
<th align="left">var1_Treated</th>
<th align="left">var1_Xanomeline High Dose</th>
<th align="left">var1_Xanomeline Low Dose</th>
<th align="right">ord_layer_index</th>
<th align="right">ord_layer_1</th>
<th align="right">ord_layer_2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">F</td>
<td align="left">COMPLETED</td>
<td align="left">34 ( 39.5%)</td>
<td align="left">64 ( 25.2%)</td>
<td align="left">30 ( 17.9%)</td>
<td align="left">13 ( 15.5%)</td>
<td align="left">17 ( 20.2%)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">F</td>
<td align="left">DISCONTINUED</td>
<td align="left">19 ( 22.1%)</td>
<td align="left">79 ( 31.1%)</td>
<td align="left">60 ( 35.7%)</td>
<td align="left">27 ( 32.1%)</td>
<td align="left">33 ( 39.3%)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">M</td>
<td align="left">COMPLETED</td>
<td align="left">24 ( 27.9%)</td>
<td align="left">46 ( 18.1%)</td>
<td align="left">22 ( 13.1%)</td>
<td align="left">14 ( 16.7%)</td>
<td align="left">8 ( 9.5%)</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="left">DISCONTINUED</td>
<td align="left">9 ( 10.5%)</td>
<td align="left">65 ( 25.6%)</td>
<td align="left">56 ( 33.3%)</td>
<td align="left">30 ( 35.7%)</td>
<td align="left">26 ( 31.0%)</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">F</td>
<td align="left">n</td>
<td align="left">53</td>
<td align="left">143</td>
<td align="left">90</td>
<td align="left">40</td>
<td align="left">50</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">F</td>
<td align="left">Mean (SD)</td>
<td align="left">156.06 ( 8.010)</td>
<td align="left">157.25 ( 7.374)</td>
<td align="left">157.94 ( 6.924)</td>
<td align="left">158.02 ( 6.370)</td>
<td align="left">157.88 ( 7.401)</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">F</td>
<td align="left">Median</td>
<td align="left">156.20</td>
<td align="left">157.50</td>
<td align="left">157.50</td>
<td align="left">157.50</td>
<td align="left">157.85</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">F</td>
<td align="left">Q1, Q3</td>
<td align="left">149.90, 162.60</td>
<td align="left">152.40, 162.60</td>
<td align="left">154.00, 162.60</td>
<td align="left">154.28, 164.12</td>
<td align="left">154.00, 162.60</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">F</td>
<td align="left">Min, Max</td>
<td align="left">137.2, 174.0</td>
<td align="left">135.9, 175.3</td>
<td align="left">135.9, 175.3</td>
<td align="left">146.1, 170.2</td>
<td align="left">135.9, 175.3</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">F</td>
<td align="left">Missing</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">M</td>
<td align="left">n</td>
<td align="left">33</td>
<td align="left">111</td>
<td align="left">78</td>
<td align="left">44</td>
<td align="left">34</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="left">Mean (SD)</td>
<td align="left">173.03 ( 8.088)</td>
<td align="left">172.55 ( 7.946)</td>
<td align="left">172.34 ( 7.929)</td>
<td align="left">172.91 ( 7.304)</td>
<td align="left">171.60 ( 8.729)</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">M</td>
<td align="left">Median</td>
<td align="left">174.00</td>
<td align="left">172.70</td>
<td align="left">172.70</td>
<td align="left">172.70</td>
<td align="left">172.10</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="left">Q1, Q3</td>
<td align="left">170.20, 177.80</td>
<td align="left">168.25, 177.80</td>
<td align="left">167.60, 177.80</td>
<td align="left">170.15, 177.80</td>
<td align="left">165.42, 177.48</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">M</td>
<td align="left">Min, Max</td>
<td align="left">144.8, 185.4</td>
<td align="left">144.8, 195.6</td>
<td align="left">147.3, 195.6</td>
<td align="left">147.3, 190.5</td>
<td align="left">157.5, 195.6</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="left">Missing</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
<p>In this table, we have:</p>
<ul>
<li>Added a ‘Total’ treatment group</li>
<li>Added a ‘Treated’ group made up of the two treated cohorts</li>
<li>Created a count layer for “End of Study Status”, reported by sex</li>
<li>Created a descriptive statistics layer for Height at Baseline, reported by sex</li>
</ul>
<p>Now let’s dig in.</p>
<div id="sorting-table-columns" class="section level2">
<h2 class="hasAnchor">
<a href="#sorting-table-columns" class="anchor"></a>Sorting Table Columns</h2>
<div id="ordering-helpers" class="section level3">
<h3 class="hasAnchor">
<a href="#ordering-helpers" class="anchor"></a>Ordering Helpers</h3>
<p>Ordering helpers are columns added into ‘Tplyr’ tables to make sure that you can sort the display to your preference. In general, ‘Tplyr’ will create:</p>
<ul>
<li>One order variable to order layers</li>
<li>One order variable for each by variable</li>
<li>At least one order variable for the target variables</li>
</ul>
<p>In the example above, the <code>t</code> table outputs with three columns:</p>
<ul>
<li>
<code>ord_layer_index</code> indexes the layer itself.</li>
<li>
<code>ord_layer_1</code> indexes the first by variable, <code>SEX</code>. No options were presented so sorting was done alphabetically.</li>
<li>
<code>ord_layer_2</code> indexes the values of the <code>EOSSTT</code> variable in the count layer, and the names of the summaries in the desc layer.</li>
</ul>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">t</span> <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"ord"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="right">ord_layer_index</th>
<th align="right">ord_layer_1</th>
<th align="right">ord_layer_2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
</div>
<div id="reordering-and-droping-columns" class="section level3">
<h3 class="hasAnchor">
<a href="#reordering-and-droping-columns" class="anchor"></a>Reordering and Droping Columns</h3>
<p>Column selection from data frames is something that is already very well done in R. The functions <code><a href="https://dplyr.tidyverse.org/reference/select.html">dplyr::select()</a></code>, <code>dplyr::relocate()</code>, <code><a href="https://rdrr.io/pkg/magrittr/man/aliases.html">magrittr::extract()</a></code>, and <code><a href="https://rdrr.io/r/base/Extract.html">[</a></code> can all be used to reorder and drop column cleanly and concisely based on a user’s preference.</p>
<p>To drop the ordering helpers, you can easily subtract them with ‘dplyr’ and ‘tidyselect’.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">t</span> <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(-<span class="fu">starts_with</span>(<span class="st">"ord_"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">row_label2</th>
<th align="left">var1_Placebo</th>
<th align="left">var1_Total</th>
<th align="left">var1_Treated</th>
<th align="left">var1_Xanomeline High Dose</th>
<th align="left">var1_Xanomeline Low Dose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">F</td>
<td align="left">COMPLETED</td>
<td align="left">34 ( 39.5%)</td>
<td align="left">64 ( 25.2%)</td>
<td align="left">30 ( 17.9%)</td>
<td align="left">13 ( 15.5%)</td>
<td align="left">17 ( 20.2%)</td>
</tr>
<tr class="even">
<td align="left">F</td>
<td align="left">DISCONTINUED</td>
<td align="left">19 ( 22.1%)</td>
<td align="left">79 ( 31.1%)</td>
<td align="left">60 ( 35.7%)</td>
<td align="left">27 ( 32.1%)</td>
<td align="left">33 ( 39.3%)</td>
</tr>
<tr class="odd">
<td align="left">M</td>
<td align="left">COMPLETED</td>
<td align="left">24 ( 27.9%)</td>
<td align="left">46 ( 18.1%)</td>
<td align="left">22 ( 13.1%)</td>
<td align="left">14 ( 16.7%)</td>
<td align="left">8 ( 9.5%)</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="left">DISCONTINUED</td>
<td align="left">9 ( 10.5%)</td>
<td align="left">65 ( 25.6%)</td>
<td align="left">56 ( 33.3%)</td>
<td align="left">30 ( 35.7%)</td>
<td align="left">26 ( 31.0%)</td>
</tr>
<tr class="odd">
<td align="left">F</td>
<td align="left">n</td>
<td align="left">53</td>
<td align="left">143</td>
<td align="left">90</td>
<td align="left">40</td>
<td align="left">50</td>
</tr>
<tr class="even">
<td align="left">F</td>
<td align="left">Mean (SD)</td>
<td align="left">156.06 ( 8.010)</td>
<td align="left">157.25 ( 7.374)</td>
<td align="left">157.94 ( 6.924)</td>
<td align="left">158.02 ( 6.370)</td>
<td align="left">157.88 ( 7.401)</td>
</tr>
<tr class="odd">
<td align="left">F</td>
<td align="left">Median</td>
<td align="left">156.20</td>
<td align="left">157.50</td>
<td align="left">157.50</td>
<td align="left">157.50</td>
<td align="left">157.85</td>
</tr>
<tr class="even">
<td align="left">F</td>
<td align="left">Q1, Q3</td>
<td align="left">149.90, 162.60</td>
<td align="left">152.40, 162.60</td>
<td align="left">154.00, 162.60</td>
<td align="left">154.28, 164.12</td>
<td align="left">154.00, 162.60</td>
</tr>
<tr class="odd">
<td align="left">F</td>
<td align="left">Min, Max</td>
<td align="left">137.2, 174.0</td>
<td align="left">135.9, 175.3</td>
<td align="left">135.9, 175.3</td>
<td align="left">146.1, 170.2</td>
<td align="left">135.9, 175.3</td>
</tr>
<tr class="even">
<td align="left">F</td>
<td align="left">Missing</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">M</td>
<td align="left">n</td>
<td align="left">33</td>
<td align="left">111</td>
<td align="left">78</td>
<td align="left">44</td>
<td align="left">34</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="left">Mean (SD)</td>
<td align="left">173.03 ( 8.088)</td>
<td align="left">172.55 ( 7.946)</td>
<td align="left">172.34 ( 7.929)</td>
<td align="left">172.91 ( 7.304)</td>
<td align="left">171.60 ( 8.729)</td>
</tr>
<tr class="odd">
<td align="left">M</td>
<td align="left">Median</td>
<td align="left">174.00</td>
<td align="left">172.70</td>
<td align="left">172.70</td>
<td align="left">172.70</td>
<td align="left">172.10</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="left">Q1, Q3</td>
<td align="left">170.20, 177.80</td>
<td align="left">168.25, 177.80</td>
<td align="left">167.60, 177.80</td>
<td align="left">170.15, 177.80</td>
<td align="left">165.42, 177.48</td>
</tr>
<tr class="odd">
<td align="left">M</td>
<td align="left">Min, Max</td>
<td align="left">144.8, 185.4</td>
<td align="left">144.8, 195.6</td>
<td align="left">147.3, 195.6</td>
<td align="left">147.3, 190.5</td>
<td align="left">157.5, 195.6</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="left">Missing</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
</tbody>
</table>
<p>Or you can reorder columns. In this example the “Total” result column is moved to the front of the results.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">t</span> <span class="kw">%&gt;%</span>
  <span class="fu">select</span>( <span class="fu">starts_with</span>(<span class="st">"row"</span>), <span class="no">var1_Total</span>, <span class="fu">starts_with</span>(<span class="st">"var1"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">row_label2</th>
<th align="left">var1_Total</th>
<th align="left">var1_Placebo</th>
<th align="left">var1_Treated</th>
<th align="left">var1_Xanomeline High Dose</th>
<th align="left">var1_Xanomeline Low Dose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">F</td>
<td align="left">COMPLETED</td>
<td align="left">64 ( 25.2%)</td>
<td align="left">34 ( 39.5%)</td>
<td align="left">30 ( 17.9%)</td>
<td align="left">13 ( 15.5%)</td>
<td align="left">17 ( 20.2%)</td>
</tr>
<tr class="even">
<td align="left">F</td>
<td align="left">DISCONTINUED</td>
<td align="left">79 ( 31.1%)</td>
<td align="left">19 ( 22.1%)</td>
<td align="left">60 ( 35.7%)</td>
<td align="left">27 ( 32.1%)</td>
<td align="left">33 ( 39.3%)</td>
</tr>
<tr class="odd">
<td align="left">M</td>
<td align="left">COMPLETED</td>
<td align="left">46 ( 18.1%)</td>
<td align="left">24 ( 27.9%)</td>
<td align="left">22 ( 13.1%)</td>
<td align="left">14 ( 16.7%)</td>
<td align="left">8 ( 9.5%)</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="left">DISCONTINUED</td>
<td align="left">65 ( 25.6%)</td>
<td align="left">9 ( 10.5%)</td>
<td align="left">56 ( 33.3%)</td>
<td align="left">30 ( 35.7%)</td>
<td align="left">26 ( 31.0%)</td>
</tr>
<tr class="odd">
<td align="left">F</td>
<td align="left">n</td>
<td align="left">143</td>
<td align="left">53</td>
<td align="left">90</td>
<td align="left">40</td>
<td align="left">50</td>
</tr>
<tr class="even">
<td align="left">F</td>
<td align="left">Mean (SD)</td>
<td align="left">157.25 ( 7.374)</td>
<td align="left">156.06 ( 8.010)</td>
<td align="left">157.94 ( 6.924)</td>
<td align="left">158.02 ( 6.370)</td>
<td align="left">157.88 ( 7.401)</td>
</tr>
<tr class="odd">
<td align="left">F</td>
<td align="left">Median</td>
<td align="left">157.50</td>
<td align="left">156.20</td>
<td align="left">157.50</td>
<td align="left">157.50</td>
<td align="left">157.85</td>
</tr>
<tr class="even">
<td align="left">F</td>
<td align="left">Q1, Q3</td>
<td align="left">152.40, 162.60</td>
<td align="left">149.90, 162.60</td>
<td align="left">154.00, 162.60</td>
<td align="left">154.28, 164.12</td>
<td align="left">154.00, 162.60</td>
</tr>
<tr class="odd">
<td align="left">F</td>
<td align="left">Min, Max</td>
<td align="left">135.9, 175.3</td>
<td align="left">137.2, 174.0</td>
<td align="left">135.9, 175.3</td>
<td align="left">146.1, 170.2</td>
<td align="left">135.9, 175.3</td>
</tr>
<tr class="even">
<td align="left">F</td>
<td align="left">Missing</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">M</td>
<td align="left">n</td>
<td align="left">111</td>
<td align="left">33</td>
<td align="left">78</td>
<td align="left">44</td>
<td align="left">34</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="left">Mean (SD)</td>
<td align="left">172.55 ( 7.946)</td>
<td align="left">173.03 ( 8.088)</td>
<td align="left">172.34 ( 7.929)</td>
<td align="left">172.91 ( 7.304)</td>
<td align="left">171.60 ( 8.729)</td>
</tr>
<tr class="odd">
<td align="left">M</td>
<td align="left">Median</td>
<td align="left">172.70</td>
<td align="left">174.00</td>
<td align="left">172.70</td>
<td align="left">172.70</td>
<td align="left">172.10</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="left">Q1, Q3</td>
<td align="left">168.25, 177.80</td>
<td align="left">170.20, 177.80</td>
<td align="left">167.60, 177.80</td>
<td align="left">170.15, 177.80</td>
<td align="left">165.42, 177.48</td>
</tr>
<tr class="odd">
<td align="left">M</td>
<td align="left">Min, Max</td>
<td align="left">144.8, 195.6</td>
<td align="left">144.8, 185.4</td>
<td align="left">147.3, 195.6</td>
<td align="left">147.3, 190.5</td>
<td align="left">157.5, 195.6</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="left">Missing</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
</tbody>
</table>
<p>For more information, it’s well worth your time to familiarize yourself with the <a href="https://dplyr.tidyverse.org/reference/select.html">select helpers</a> that work with ‘dplyr’.</p>
</div>
</div>
<div id="sorting-the-layers" class="section level2">
<h2 class="hasAnchor">
<a href="#sorting-the-layers" class="anchor"></a>Sorting the Layers</h2>
<p>Layers are one of the fundamental building blocks of ‘Tplyr’. Each layer executes independently, and at the end of a build they’re bound together. The <code>ord_layer_index</code> variable allows you differentiate and sort layers after the table is built. Layers are indexed in the order in which they were added to the table using <code><a href="../reference/layer_attachment.html">add_layer()</a></code> or <code><a href="../reference/layer_attachment.html">add_layers()</a></code>. For example, let’s say you wanted to reverse the order of the layers.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">t</span> <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"row"</span>), <span class="fu">starts_with</span>(<span class="st">"ord"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="no">ord_layer_index</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">row_label2</th>
<th align="right">ord_layer_index</th>
<th align="right">ord_layer_1</th>
<th align="right">ord_layer_2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">F</td>
<td align="left">n</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">F</td>
<td align="left">Mean (SD)</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">F</td>
<td align="left">Median</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">F</td>
<td align="left">Q1, Q3</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">F</td>
<td align="left">Min, Max</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">F</td>
<td align="left">Missing</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">M</td>
<td align="left">n</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="left">Mean (SD)</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">M</td>
<td align="left">Median</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="left">Q1, Q3</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">M</td>
<td align="left">Min, Max</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="left">Missing</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">F</td>
<td align="left">COMPLETED</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">F</td>
<td align="left">DISCONTINUED</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">M</td>
<td align="left">COMPLETED</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="left">DISCONTINUED</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
</div>
<div id="sorting-the-by-varaibles" class="section level2">
<h2 class="hasAnchor">
<a href="#sorting-the-by-varaibles" class="anchor"></a>Sorting the <code>by</code> varaibles</h2>
<p>Each <code>by</code> variable gets its own order column as well. These will be named <code>ord_layer_&lt;n&gt;</code> where <code>&lt;n&gt;</code> typically relates back to the <code>row_label</code> variable (this isn’t necessarily the case when count layers are nested - see the vignette(“Count_and_Shift_Tables”)).</p>
<p>These order variables will calculate based on the first applicable method below.</p>
<ol style="list-style-type: decimal">
<li>If the variable has a <code>VARN</code> variable in the <code>target</code> dataset, (i.e. <code>AVISIT</code> has <code>AVISITN</code>, or <code>PARAM</code> has <code>PARAMN</code>), that variable will be extracted and used as the ordering variable associated with that row label.</li>
<li>If the <code>by</code> variable is a factor, the values of the ordering column will be associated with the factor levels.</li>
<li>If neither 1 or 2 are true, the values in the ordering column will be based on an alphabetical sorting. The resulting column will be numeric.</li>
</ol>
<div id="varn" class="section level3">
<h3 class="hasAnchor">
<a href="#varn" class="anchor"></a>VARN</h3>
<p>To demonstrate the use of <code>VARN</code> sorting, consider the variable <code>RACE.</code> In <code>ADSL</code>, <code>RACE</code> also has <code>RACEN</code>:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">adsl</span> <span class="kw">%&gt;%</span>
  <span class="fu">distinct</span>(<span class="no">RACEN</span>, <span class="no">RACE</span>) <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="right">RACEN</th>
<th align="left">RACE</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">WHITE</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">BLACK OR AFRICAN AMERICAN</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="left">AMERICAN INDIAN OR ALASKA NATIVE</td>
</tr>
</tbody>
</table>
<p>‘Tplyr’ will automatically figure this out for you, and pull the <code>RACEN</code> values into the variable <code>ord_layer_1</code>.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adsl</span>, <span class="no">TRT01A</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span>(<span class="no">EOSSTT</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="no">RACE</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="no">row_label1</span>, <span class="no">row_label2</span>, <span class="no">ord_layer_1</span>) <span class="kw">%&gt;%</span>
  <span class="fu">arrange</span>(<span class="no">ord_layer_1</span>) <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">row_label2</th>
<th align="right">ord_layer_1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">WHITE</td>
<td align="left">COMPLETED</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">WHITE</td>
<td align="left">DISCONTINUED</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">BLACK OR AFRICAN AMERICAN</td>
<td align="left">COMPLETED</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">BLACK OR AFRICAN AMERICAN</td>
<td align="left">DISCONTINUED</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">AMERICAN INDIAN OR ALASKA NATIVE</td>
<td align="left">COMPLETED</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">AMERICAN INDIAN OR ALASKA NATIVE</td>
<td align="left">DISCONTINUED</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
</div>
<div id="factor" class="section level3">
<h3 class="hasAnchor">
<a href="#factor" class="anchor"></a>Factor</h3>
<p>If there’s no <code>VARN</code> variable in the target dataset, ‘Tplyr’ will then check if the variable you provided is a factor. If you’re new to R, spending some time trying to understand factor variables is quite worthwhile. Let’s look at example using the variable <code>ETHNIC</code> and see some of the advantages in practice.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">adsl</span>$<span class="no">ETHNIC</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">adsl</span>$<span class="no">ETHNIC</span>, <span class="kw">levels</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"HISPANIC OR LATINO"</span>, <span class="st">"NOT HISPANIC OR LATINO"</span>, <span class="st">"DUMMMY"</span>))
<span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adsl</span>, <span class="no">TRT01A</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span>(<span class="no">EOSSTT</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="no">ETHNIC</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="no">row_label1</span>, <span class="no">row_label2</span>, <span class="no">ord_layer_1</span>) <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">row_label2</th>
<th align="right">ord_layer_1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">HISPANIC OR LATINO</td>
<td align="left">COMPLETED</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">HISPANIC OR LATINO</td>
<td align="left">DISCONTINUED</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">NOT HISPANIC OR LATINO</td>
<td align="left">COMPLETED</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">NOT HISPANIC OR LATINO</td>
<td align="left">DISCONTINUED</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">DUMMMY</td>
<td align="left">COMPLETED</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">DUMMMY</td>
<td align="left">DISCONTINUED</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>Factor variables have ‘levels’. These levels are essentially what the <code>VARN</code> variables are trying to achieve - they specify the order of the different values within the associated variable. The variable we set above specifies that “HISPANIC OR LATINO” should sort first, then “NOT HISPANIC OR LATINO”, and finally “DUMMY”. Notice how they’re not alphabetical?</p>
<p>A highly advantageous aspect of using factor variables in ‘Tplyr’ is that factor variables can be used to insert dummy values into your table. Consider this line of code from above:</p>
<pre><code>adsl$ETHNIC &lt;- factor(adsl$ETHNIC, levels=c("HISPANIC OR LATINO", "NOT HISPANIC OR LATINO", "DUMMMY"))</code></pre>
<p>This is converting the variable <code>ETHNIC</code> to a factor, then setting the factor levels. But it doesn’t <em>change</em> any of the values in the dataset - there are no values of “dummy” within <code>ETHNIC</code> in ADSL. Yet in the output built above, you see rows for “DUMMY”. By using factors, you can insert rows into your ‘Tplyr’ table that don’t exist in the data. This is particularly helpful if you’re working with data early on in a study, where certain values are expected, yet do not currently exist in the data. This will help you prepare tables that are complete even when your data are not.</p>
</div>
<div id="alphabetical" class="section level3">
<h3 class="hasAnchor">
<a href="#alphabetical" class="anchor"></a>Alphabetical</h3>
<p>Lastly, If the target doesn’t have a <code>VARN</code> variable in the target dataset and isn’t a factor, ‘Tplyr’ will sort the variable alphabetically. The resulting order variable will be numeric, simply numbering each of the variable values alphabetically. Nothing fancy to it!</p>
</div>
</div>
<div id="sorting-descriptive-statistic-summaries" class="section level2">
<h2 class="hasAnchor">
<a href="#sorting-descriptive-statistic-summaries" class="anchor"></a>Sorting Descriptive Statistic Summaries</h2>
<p>After the <code>by</code> variables, each layer will sort results slightly differently. We’ll start with the most simple case - descriptive statistic layers. As the user, you have full control over the order in which results present using <code><a href="../reference/set_format_strings.html">set_format_strings()</a></code>. Results will be ordered based on the order in which you create your <code><a href="../reference/f_str.html">f_str()</a></code> objects.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adsl</span>, <span class="no">TRT01A</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_desc</a></span>(<span class="no">HEIGHTBL</span>) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/set_format_strings.html">set_format_strings</a></span>(
        <span class="st">'Group 1'</span> <span class="kw">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">'xx.x'</span>, <span class="no">mean</span>),
        <span class="st">'Group 2'</span> <span class="kw">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">'xx.x'</span>, <span class="no">median</span>),
        <span class="st">'Group 3'</span> <span class="kw">=</span> <span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">'xx.x'</span>, <span class="no">sd</span>)
      )
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"row"</span>), <span class="fu">starts_with</span>(<span class="st">"ord"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="right">ord_layer_index</th>
<th align="right">ord_layer_1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Group 1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Group 2</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Group 3</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<p>Each of the separate “Groups” added above were indexed based on their position in <code><a href="../reference/set_format_strings.html">set_format_strings()</a></code>. If you’d like to change the order, all you need to do is update your <code><a href="../reference/set_format_strings.html">set_format_strings()</a></code> call.</p>
</div>
<div id="sorting-count-layers" class="section level2">
<h2 class="hasAnchor">
<a href="#sorting-count-layers" class="anchor"></a>Sorting Count Layers</h2>
<p>The order in which results appear on a frequency table can be deceptively complex and depends on the situation at hand. With this in mind, ‘Tplyr’ has 3 different methods of ordering the results of a count layer using the function <code><a href="../reference/ordering.html">set_order_count_method()</a></code>:</p>
<ol style="list-style-type: decimal">
<li>
<strong>“byfactor”</strong> - The default method is to sort by a factor. If the input variable is not a factor, alphabetical sorting will be used.</li>
<li>
<strong>“byvarn”</strong> - Similar to a ‘by’ variable, a count target can be sorted with a VARN variable existing in the target dataset.</li>
<li>
<strong>“bycount”</strong> - This is the most complex method. Many tables require counts to be sorted based on the counts within a particular group, like a treatment variable. ‘Tplyr’ can populate the ordering column based on numeric values within any results column. This requires some more granular control, for which we’ve created the functions <code><a href="../reference/ordering.html">set_ordering_cols()</a></code> and <code>set_numeric_result_order_var()</code> to specify the column and numeric value on which the ordering column should be based.</li>
</ol>
<div id="byfactor-and-byvarn" class="section level3">
<h3 class="hasAnchor">
<a href="#byfactor-and-byvarn" class="anchor"></a>“byfactor” and “byvarn”</h3>
<p>“byfactor” is the default ordering method of results for count layers. Both “byfactor” and “byvarn” behave exactly like the order variables associated with <code>by</code> variables in a ‘Tplyr’ table. For “byvarn”, you must set the sort method using <code><a href="../reference/ordering.html">set_order_count_method()</a></code>.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">adsl</span>$<span class="no">AGEGR1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">adsl</span>$<span class="no">AGEGR1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"&lt;65"</span>, <span class="st">"65-80"</span>, <span class="st">"&gt;80"</span>))
<span class="co"># Warnings suppressed to remove 'forcats' implicit NA warning</span>
<span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span>({
  <span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adsl</span>, <span class="no">TRT01A</span>) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
      <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span>(<span class="no">AGEGR1</span>) <span class="kw">%&gt;%</span>
        <span class="co"># This is the default and not needed</span>
        <span class="fu"><a href="../reference/ordering.html">set_order_count_method</a></span>(<span class="st">"byfactor"</span>)
    ) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
    <span class="fu">select</span>(<span class="no">row_label1</span>, <span class="no">ord_layer_1</span>) <span class="kw">%&gt;%</span>
    <span class="fu">kable</span>()
})</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="right">ord_layer_1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">&lt;65</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">65-80</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">&gt;80</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adsl</span>, <span class="no">TRT01A</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span>(<span class="no">RACE</span>) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/ordering.html">set_order_count_method</a></span>(<span class="st">"byvarn"</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="no">row_label1</span>, <span class="no">ord_layer_1</span>) <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="right">ord_layer_1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">AMERICAN INDIAN OR ALASKA NATIVE</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">BLACK OR AFRICAN AMERICAN</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">WHITE</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div id="bycount" class="section level3">
<h3 class="hasAnchor">
<a href="#bycount" class="anchor"></a>“bycount”</h3>
<p>Using count-based sorting is where things get more complicated. There are multiple items to consider:</p>
<ul>
<li>What column do you want to sort by?</li>
<li>If there are multiple numbers in the column, like “n (%) [event]” type tables, which number should be used to create the sort variable?</li>
</ul>
<p>We’ve create helper functions to aid in making this step more intuitive from a user perspetive, and to maintain the flexibility that you need. The two functions that you need here are <code><a href="../reference/ordering.html">set_ordering_cols()</a></code> and <code><a href="../reference/ordering.html">set_result_order_var()</a></code>.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adae</span>, <span class="no">TRTA</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span>(<span class="no">AEDECOD</span>) <span class="kw">%&gt;%</span>
      <span class="co"># This will present 3 numbers in a cell</span>
      <span class="fu"><a href="../reference/set_format_strings.html">set_format_strings</a></span>(<span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">"xx (xx.x%) [x]"</span>, <span class="no">distinct</span>, <span class="no">distinct_pct</span>, <span class="no">n</span>)) <span class="kw">%&gt;%</span>
      <span class="co"># This makes the distinct numbers available</span>
      <span class="fu"><a href="../reference/set_distinct_by.html">set_distinct_by</a></span>(<span class="no">USUBJID</span>) <span class="kw">%&gt;%</span>
      <span class="co"># Choosing "bycount" ordering for the result variable</span>
      <span class="fu"><a href="../reference/ordering.html">set_order_count_method</a></span>(<span class="st">"bycount"</span>) <span class="kw">%&gt;%</span>
      <span class="co"># This will target the results column for Xanomeline High Dose, or `var1_Xanomeline High Dose`</span>
      <span class="fu"><a href="../reference/ordering.html">set_ordering_cols</a></span>(<span class="st">"Xanomeline High Dose"</span>) <span class="kw">%&gt;%</span>
      <span class="co"># The number we want to pull out is the distinct N counts</span>
      <span class="fu"><a href="../reference/ordering.html">set_result_order_var</a></span>(<span class="no">distinct_n</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="no">ord_layer_1</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="no">row_label1</span>, <span class="no">`var1_Xanomeline High Dose`</span>, <span class="no">ord_layer_1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">var1_Xanomeline High Dose</th>
<th align="right">ord_layer_1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">PRURITUS</td>
<td align="left">26 (61.9%) [38]</td>
<td align="right">26</td>
</tr>
<tr class="even">
<td align="left">ERYTHEMA</td>
<td align="left">14 (33.3%) [22]</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="left">RASH</td>
<td align="left">11 (26.2%) [18]</td>
<td align="right">11</td>
</tr>
<tr class="even">
<td align="left">HYPERHIDROSIS</td>
<td align="left">8 (19.0%) [10]</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="left">SKIN IRRITATION</td>
<td align="left">5 (11.9%) [8]</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">RASH PRURITIC</td>
<td align="left">2 ( 4.8%) [3]</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<p>In the above example, the results columns of the output table actually contain three different numbers: the distinct counts, the distinct percentage, and the non-distinct counts. We want to use distinct counts, so we choose <code>distinct_n</code>.</p>
<p>The next question that we need to answer when sorting by counts is which result column to take counts out of. Here, we have three results columns - one for each treatment group in the dataset. We want to use the results for the treatment group “Xanomeline High Dose”, so we provide the name of the treatment group.</p>
<p>But what if you have an additional column variable on top of the treatment groups?</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adae</span>, <span class="no">TRTA</span>, <span class="kw">cols</span><span class="kw">=</span><span class="no">SEX</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span>(<span class="no">AEDECOD</span>) <span class="kw">%&gt;%</span>
      <span class="co"># This will present 3 numbers in a cell</span>
      <span class="fu"><a href="../reference/set_format_strings.html">set_format_strings</a></span>(<span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">"xx (xx.x%) [x]"</span>, <span class="no">distinct</span>, <span class="no">distinct_pct</span>, <span class="no">n</span>)) <span class="kw">%&gt;%</span>
      <span class="co"># This makes the distinct numbers available</span>
      <span class="fu"><a href="../reference/set_distinct_by.html">set_distinct_by</a></span>(<span class="no">USUBJID</span>) <span class="kw">%&gt;%</span>
      <span class="co"># Choosing "bycount" ordering for the result variable</span>
      <span class="fu"><a href="../reference/ordering.html">set_order_count_method</a></span>(<span class="st">"bycount"</span>) <span class="kw">%&gt;%</span>
      <span class="co"># This will target the results column for Xanomeline High Dose, or `var1_Xanomeline High Dose`</span>
      <span class="fu"><a href="../reference/ordering.html">set_ordering_cols</a></span>(<span class="st">"Xanomeline High Dose"</span>, <span class="st">"F"</span>) <span class="kw">%&gt;%</span>
      <span class="co"># The number we want to pull out is the distinct N counts</span>
      <span class="fu"><a href="../reference/ordering.html">set_result_order_var</a></span>(<span class="no">distinct_n</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="no">ord_layer_1</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="no">row_label1</span>, <span class="no">`var1_Xanomeline High Dose_F`</span>, <span class="no">ord_layer_1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">var1_Xanomeline High Dose_F</th>
<th align="right">ord_layer_1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">PRURITUS</td>
<td align="left">11 (78.6%) [14]</td>
<td align="right">11</td>
</tr>
<tr class="even">
<td align="left">ERYTHEMA</td>
<td align="left">7 (50.0%) [8]</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="left">RASH</td>
<td align="left">3 (21.4%) [5]</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">HYPERHIDROSIS</td>
<td align="left">2 (14.3%) [2]</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">RASH PRURITIC</td>
<td align="left">1 ( 7.1%) [1]</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">SKIN IRRITATION</td>
<td align="left">1 ( 7.1%) [2]</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>Here we’re ordering on the female subjects in the “Xanomeline High Dose” cohort. In <code><a href="../reference/ordering.html">set_result_order_var()</a></code>, you need to enter the values from each variable between <code>treat_var</code> and any variable entered in <code>cols</code> that you’d like to extract.</p>
</div>
</div>
<div id="nested-sorting" class="section level2">
<h2 class="hasAnchor">
<a href="#nested-sorting" class="anchor"></a>Nested Sorting</h2>
<p>Nested count layers add one more piece to the puzzle. As a reminder, nested count layers are count summaries that are summarizing both a grouping variable, and a variable that’s being grouped. The best example is probably Adverse Event tables, where we want to see adverse events that occurred within different body systems.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adae</span>, <span class="no">TRTA</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span>(<span class="fu">vars</span>(<span class="no">AEBODSYS</span>, <span class="no">AEDECOD</span>))
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">row_label2</th>
<th align="left">var1_Placebo</th>
<th align="left">var1_Xanomeline High Dose</th>
<th align="left">var1_Xanomeline Low Dose</th>
<th align="right">ord_layer_index</th>
<th align="right">ord_layer_1</th>
<th align="right">ord_layer_2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">SKIN AND SUBCUTANEOUS TISSUE DISORDERS</td>
<td align="left">SKIN AND SUBCUTANEOUS TISSUE DISORDERS</td>
<td align="left">47 (100.0%)</td>
<td align="left">111 (100.0%)</td>
<td align="left">118 (100.0%)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">Inf</td>
</tr>
<tr class="even">
<td align="left">SKIN AND SUBCUTANEOUS TISSUE DISORDERS</td>
<td align="left">ACTINIC KERATOSIS</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">1 ( 0.9%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">SKIN AND SUBCUTANEOUS TISSUE DISORDERS</td>
<td align="left">ALOPECIA</td>
<td align="left">1 ( 2.1%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">SKIN AND SUBCUTANEOUS TISSUE DISORDERS</td>
<td align="left">BLISTER</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">2 ( 1.8%)</td>
<td align="left">8 ( 6.8%)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">SKIN AND SUBCUTANEOUS TISSUE DISORDERS</td>
<td align="left">COLD SWEAT</td>
<td align="left">3 ( 6.4%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">SKIN AND SUBCUTANEOUS TISSUE DISORDERS</td>
<td align="left">DERMATITIS ATOPIC</td>
<td align="left">1 ( 2.1%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="left">0 ( 0.0%)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">5</td>
</tr>
</tbody>
</table>
<p>In a layer that uses nesting, we need one more order variable - as we’re now concerned with the sorting of both the outside and inside variable. Counts are being summarized for both - so we need to know how both should be sorted. Additionally, we need to make sure that, in this case, the adverse events within a body system stay within the rows of that body system.</p>
<p>These result variables will always be the last two order variables output by ‘Tplyr’. In the above example, <code>ord_layer_1</code> is for <code>AEBODSYS</code> and <code>ord_layer_2</code> is for AEDECOD. Note that <code>ord_layer_2</code> has <code>Inf</code> where <code>row_label1</code> and <code>row_label2</code> are both equal. This is the row that summarizes the <code>AEBODSYS</code> counts. By default, ‘Tplyr’ is set to assume that you will use <strong>descending</strong> sort on the order variable associated with the inside count variable (i.e. <code>AEDECOD</code>). This is because in nested count layer you will often want to sort by descending occurrence of the inside target variable. If you’d like to use ascending sorting instead, we offer the function <code><a href="../reference/set_outer_sort_position.html">set_outer_sort_position()</a></code>.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adae</span>, <span class="no">TRTA</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span>(<span class="fu">vars</span>(<span class="no">AEBODSYS</span>, <span class="no">AEDECOD</span>)) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/set_outer_sort_position.html">set_outer_sort_position</a></span>(<span class="st">"asc"</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">arrange</span>(<span class="no">ord_layer_1</span>, <span class="no">ord_layer_2</span>) <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"row"</span>), <span class="fu">starts_with</span>(<span class="st">"ord_layer"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">row_label2</th>
<th align="right">ord_layer_index</th>
<th align="right">ord_layer_1</th>
<th align="right">ord_layer_2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">SKIN AND SUBCUTANEOUS TISSUE DISORDERS</td>
<td align="left">SKIN AND SUBCUTANEOUS TISSUE DISORDERS</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-Inf</td>
</tr>
<tr class="even">
<td align="left">SKIN AND SUBCUTANEOUS TISSUE DISORDERS</td>
<td align="left">ACTINIC KERATOSIS</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">SKIN AND SUBCUTANEOUS TISSUE DISORDERS</td>
<td align="left">ALOPECIA</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">SKIN AND SUBCUTANEOUS TISSUE DISORDERS</td>
<td align="left">BLISTER</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">SKIN AND SUBCUTANEOUS TISSUE DISORDERS</td>
<td align="left">COLD SWEAT</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">SKIN AND SUBCUTANEOUS TISSUE DISORDERS</td>
<td align="left">DERMATITIS ATOPIC</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">5</td>
</tr>
</tbody>
</table>
<p>Notice that the <code>Inf</code> has now switched to <code>-Inf</code> to ensure that the <code>AEBODSYS</code> row stays at the top of the group.</p>
<p>Another consideration of nested sorting is whether or not you want to sort both result variables the same way. Do you want to sort both by counts? Or do you want to sort one alphabetically and the other by count? Or maybe one has a <code>VARN</code> variable associated with it? For this reason, <code><a href="../reference/ordering.html">set_order_count_method()</a></code> can take in a 2-element character vector, where the first element specifies the outside variable and the second the inside variable.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adsl</span>, <span class="no">TRT01A</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span>(<span class="fu">vars</span>(<span class="no">EOSSTT</span>, <span class="no">DCDECOD</span>)) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/ordering.html">set_order_count_method</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"byfactor"</span>, <span class="st">"bycount"</span>))
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"row"</span>), <span class="fu">starts_with</span>(<span class="st">"ord"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">row_label2</th>
<th align="right">ord_layer_index</th>
<th align="right">ord_layer_1</th>
<th align="right">ord_layer_2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">COMPLETED</td>
<td align="left">COMPLETED</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">Inf</td>
</tr>
<tr class="even">
<td align="left">COMPLETED</td>
<td align="left">COMPLETED</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">58</td>
</tr>
<tr class="odd">
<td align="left">DISCONTINUED</td>
<td align="left">DISCONTINUED</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">Inf</td>
</tr>
<tr class="even">
<td align="left">DISCONTINUED</td>
<td align="left">ADVERSE EVENT</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="left">DISCONTINUED</td>
<td align="left">DEATH</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">DISCONTINUED</td>
<td align="left">LACK OF EFFICACY</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">DISCONTINUED</td>
<td align="left">LOST TO FOLLOW-UP</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">DISCONTINUED</td>
<td align="left">PHYSICIAN DECISION</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">DISCONTINUED</td>
<td align="left">PROTOCOL VIOLATION</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">DISCONTINUED</td>
<td align="left">STUDY TERMINATED BY SPONSOR</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">DISCONTINUED</td>
<td align="left">WITHDRAWAL BY SUBJECT</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">9</td>
</tr>
</tbody>
</table>
<p>In the example above, <code>EOSTT</code> is ordered alphabetically (recall that using “byfactor” when the variable is not a factor will do alphabetical sorting), and <code>DSDECOD</code> is ordered by count.</p>
<p>If only one method is provided, that method will automatically be applied to both variables. So in the example below, “bycount” is applied to both <code>EOSTT</code> and <code>DSDECOD</code>.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adsl</span>, <span class="no">TRT01A</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/treat_grps.html">add_total_group</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span>(<span class="fu">vars</span>(<span class="no">EOSSTT</span>, <span class="no">DCDECOD</span>)) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/ordering.html">set_order_count_method</a></span>(<span class="st">"bycount"</span>) <span class="kw">%&gt;%</span>
      <span class="co">#set_order_count_method("bycount", "bycount") %&gt;% This is functionally the same.</span>
      <span class="fu"><a href="../reference/ordering.html">set_ordering_cols</a></span>(<span class="no">Total</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"row"</span>),  <span class="no">var1_Total</span>, <span class="fu">starts_with</span>(<span class="st">"ord"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">row_label2</th>
<th align="left">var1_Total</th>
<th align="right">ord_layer_index</th>
<th align="right">ord_layer_1</th>
<th align="right">ord_layer_2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">COMPLETED</td>
<td align="left">COMPLETED</td>
<td align="left">110 ( 43.3%)</td>
<td align="right">1</td>
<td align="right">110</td>
<td align="right">Inf</td>
</tr>
<tr class="even">
<td align="left">COMPLETED</td>
<td align="left">COMPLETED</td>
<td align="left">110 ( 43.3%)</td>
<td align="right">1</td>
<td align="right">110</td>
<td align="right">110</td>
</tr>
<tr class="odd">
<td align="left">DISCONTINUED</td>
<td align="left">DISCONTINUED</td>
<td align="left">144 ( 56.7%)</td>
<td align="right">1</td>
<td align="right">144</td>
<td align="right">Inf</td>
</tr>
<tr class="even">
<td align="left">DISCONTINUED</td>
<td align="left">ADVERSE EVENT</td>
<td align="left">92 ( 36.2%)</td>
<td align="right">1</td>
<td align="right">144</td>
<td align="right">92</td>
</tr>
<tr class="odd">
<td align="left">DISCONTINUED</td>
<td align="left">DEATH</td>
<td align="left">3 ( 1.2%)</td>
<td align="right">1</td>
<td align="right">144</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">DISCONTINUED</td>
<td align="left">LACK OF EFFICACY</td>
<td align="left">4 ( 1.6%)</td>
<td align="right">1</td>
<td align="right">144</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">DISCONTINUED</td>
<td align="left">LOST TO FOLLOW-UP</td>
<td align="left">2 ( 0.8%)</td>
<td align="right">1</td>
<td align="right">144</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">DISCONTINUED</td>
<td align="left">PHYSICIAN DECISION</td>
<td align="left">3 ( 1.2%)</td>
<td align="right">1</td>
<td align="right">144</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">DISCONTINUED</td>
<td align="left">PROTOCOL VIOLATION</td>
<td align="left">6 ( 2.4%)</td>
<td align="right">1</td>
<td align="right">144</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">DISCONTINUED</td>
<td align="left">STUDY TERMINATED BY SPONSOR</td>
<td align="left">7 ( 2.8%)</td>
<td align="right">1</td>
<td align="right">144</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="left">DISCONTINUED</td>
<td align="left">WITHDRAWAL BY SUBJECT</td>
<td align="left">27 ( 10.6%)</td>
<td align="right">1</td>
<td align="right">144</td>
<td align="right">27</td>
</tr>
</tbody>
</table>
</div>
<div id="sorting-shift-tables" class="section level2">
<h2 class="hasAnchor">
<a href="#sorting-shift-tables" class="anchor"></a>Sorting Shift Tables</h2>
<p>Shift tables keep things relatively simple when it comes to sorting and use the “byfactor” method seen above. We encourage this primarily because you likely want the benefits of factor variables on a shift layer. For example, consider this table:</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adlb</span>, <span class="no">TRTA</span>, <span class="kw">where</span><span class="kw">=</span><span class="no">PARAMCD</span> <span class="kw">==</span> <span class="st">"CK"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_shift</a></span>(<span class="fu">vars</span>(<span class="kw">row</span> <span class="kw">=</span> <span class="no">BNRIND</span>, <span class="kw">column</span> <span class="kw">=</span> <span class="no">ANRIND</span>), <span class="kw">by</span> <span class="kw">=</span> <span class="fu">vars</span>(<span class="no">PARAM</span>, <span class="no">AVISIT</span>))
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(-<span class="fu">starts_with</span>(<span class="st">'var1'</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fl">20</span>) <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">row_label2</th>
<th align="left">row_label3</th>
<th align="right">ord_layer_index</th>
<th align="right">ord_layer_1</th>
<th align="right">ord_layer_2</th>
<th align="right">ord_layer_3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Creatine Kinase (U/L)</td>
<td align="left">Week 12</td>
<td align="left">H</td>
<td align="right">1</td>
<td align="right">35</td>
<td align="right">12</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Creatine Kinase (U/L)</td>
<td align="left">Week 12</td>
<td align="left">N</td>
<td align="right">1</td>
<td align="right">35</td>
<td align="right">12</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">Creatine Kinase (U/L)</td>
<td align="left">Week 24</td>
<td align="left">H</td>
<td align="right">1</td>
<td align="right">35</td>
<td align="right">24</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Creatine Kinase (U/L)</td>
<td align="left">Week 24</td>
<td align="left">N</td>
<td align="right">1</td>
<td align="right">35</td>
<td align="right">24</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">Creatine Kinase (U/L)</td>
<td align="left">Week 8</td>
<td align="left">H</td>
<td align="right">1</td>
<td align="right">35</td>
<td align="right">8</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Creatine Kinase (U/L)</td>
<td align="left">Week 8</td>
<td align="left">N</td>
<td align="right">1</td>
<td align="right">35</td>
<td align="right">8</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<p>There are a few problems here:</p>
<ul>
<li>H sorts before N alphabetically</li>
<li>We’re missing the rows for “L” on most visits, even though “L” in in the data for <code>BNRIND</code>.</li>
</ul>
<p>Using a factor variables cleans this right up for us:</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">adlb</span>$<span class="no">BNRIND</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">adlb</span>$<span class="no">BNRIND</span>, <span class="kw">levels</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"L"</span>, <span class="st">"N"</span>, <span class="st">"H"</span>))
<span class="no">adlb</span>$<span class="no">ANRIND</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">adlb</span>$<span class="no">ANRIND</span>, <span class="kw">levels</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"L"</span>, <span class="st">"N"</span>, <span class="st">"H"</span>))

<span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adlb</span>, <span class="no">TRTA</span>, <span class="kw">where</span><span class="kw">=</span><span class="no">PARAMCD</span> <span class="kw">==</span> <span class="st">"CK"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_shift</a></span>(<span class="fu">vars</span>(<span class="kw">row</span> <span class="kw">=</span> <span class="no">BNRIND</span>, <span class="kw">column</span> <span class="kw">=</span> <span class="no">ANRIND</span>), <span class="kw">by</span> <span class="kw">=</span> <span class="fu">vars</span>(<span class="no">PARAM</span>, <span class="no">AVISIT</span>))
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(-<span class="fu">starts_with</span>(<span class="st">'var1'</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fl">20</span>) <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">row_label1</th>
<th align="left">row_label2</th>
<th align="left">row_label3</th>
<th align="right">ord_layer_index</th>
<th align="right">ord_layer_1</th>
<th align="right">ord_layer_2</th>
<th align="right">ord_layer_3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Creatine Kinase (U/L)</td>
<td align="left">Week 12</td>
<td align="left">L</td>
<td align="right">1</td>
<td align="right">35</td>
<td align="right">12</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Creatine Kinase (U/L)</td>
<td align="left">Week 12</td>
<td align="left">N</td>
<td align="right">1</td>
<td align="right">35</td>
<td align="right">12</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Creatine Kinase (U/L)</td>
<td align="left">Week 12</td>
<td align="left">H</td>
<td align="right">1</td>
<td align="right">35</td>
<td align="right">12</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">Creatine Kinase (U/L)</td>
<td align="left">Week 24</td>
<td align="left">L</td>
<td align="right">1</td>
<td align="right">35</td>
<td align="right">24</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Creatine Kinase (U/L)</td>
<td align="left">Week 24</td>
<td align="left">N</td>
<td align="right">1</td>
<td align="right">35</td>
<td align="right">24</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Creatine Kinase (U/L)</td>
<td align="left">Week 24</td>
<td align="left">H</td>
<td align="right">1</td>
<td align="right">35</td>
<td align="right">24</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">Creatine Kinase (U/L)</td>
<td align="left">Week 8</td>
<td align="left">L</td>
<td align="right">1</td>
<td align="right">35</td>
<td align="right">8</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Creatine Kinase (U/L)</td>
<td align="left">Week 8</td>
<td align="left">N</td>
<td align="right">1</td>
<td align="right">35</td>
<td align="right">8</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Creatine Kinase (U/L)</td>
<td align="left">Week 8</td>
<td align="left">H</td>
<td align="right">1</td>
<td align="right">35</td>
<td align="right">8</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<p>Now we have the nice “L”, “N”, “H” order that we’d like to see. Other sort methods on a shift table are fairly unlikely, as the matrix structure of the counts displayed by shift tables is relevant to the presentation and interpreting results.</p>
<p>Happy sorting!</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Eli Miller, Mike Stackhouse, Ashley Tarasiewicz, Nathan Kosiba.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
